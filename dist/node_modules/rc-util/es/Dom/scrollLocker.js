import"/node_modules/core-js/modules/es.array.iterator.js";import"/node_modules/core-js/modules/es.regexp.constructor.js";import"/node_modules/core-js/modules/es.regexp.to-string.js";import"/node_modules/core-js/modules/es.string.replace.js";import"/node_modules/core-js/modules/es.string.trim.js";import"/node_modules/core-js/modules/esnext.map.delete-all.js";import"/node_modules/core-js/modules/esnext.map.every.js";import"/node_modules/core-js/modules/esnext.map.filter.js";import"/node_modules/core-js/modules/esnext.map.find.js";import"/node_modules/core-js/modules/esnext.map.find-key.js";import"/node_modules/core-js/modules/esnext.map.includes.js";import"/node_modules/core-js/modules/esnext.map.key-of.js";import"/node_modules/core-js/modules/esnext.map.map-keys.js";import"/node_modules/core-js/modules/esnext.map.map-values.js";import"/node_modules/core-js/modules/esnext.map.merge.js";import"/node_modules/core-js/modules/esnext.map.reduce.js";import"/node_modules/core-js/modules/esnext.map.some.js";import"/node_modules/core-js/modules/esnext.map.update.js";import"/node_modules/core-js/modules/web.dom-collections.iterator.js";import _toConsumableArray from"/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js";import _classCallCheck from"/node_modules/@babel/runtime/helpers/esm/classCallCheck.js";import getScrollBarSize from"/node_modules/rc-util/es/getScrollBarSize.js";import setStyle from"/node_modules/rc-util/es/setStyle.js";var locks=[],scrollingEffectClassName="ant-scrolling-effect",scrollingEffectClassNameReg=new RegExp("".concat(scrollingEffectClassName),"g"),uuid=0,cacheStyle=new Map,ScrollLocker=function ScrollLocker(options){var _this=this;_classCallCheck(this,ScrollLocker),this.getContainer=function(){var _this$options;return null===(_this$options=_this.options)||void 0===_this$options?void 0:_this$options.container},this.reLock=function(options){var findLock=locks.find(function(_ref){var target=_ref.target;return target===_this.lockTarget});findLock&&_this.unLock(),_this.options=options,findLock&&(findLock.options=options,_this.lock())},this.lock=function(){var _this$options3;if(!locks.some(function(_ref2){var target=_ref2.target;return target===_this.lockTarget})){if(locks.some(function(_ref3){var _this$options2,options=_ref3.options;return(null===options||void 0===options?void 0:options.container)===(null===(_this$options2=_this.options)||void 0===_this$options2?void 0:_this$options2.container)}))return void(locks=[].concat(_toConsumableArray(locks),[{target:_this.lockTarget,options:_this.options}]));var scrollBarSize=0,container=(null===(_this$options3=_this.options)||void 0===_this$options3?void 0:_this$options3.container)||document.body;(container===document.body&&0<window.innerWidth-document.documentElement.clientWidth||container.scrollHeight>container.clientHeight)&&(scrollBarSize=getScrollBarSize());var containerClassName=container.className;if(0===locks.filter(function(_ref4){var _this$options4,options=_ref4.options;return(null===options||void 0===options?void 0:options.container)===(null===(_this$options4=_this.options)||void 0===_this$options4?void 0:_this$options4.container)}).length&&cacheStyle.set(container,setStyle({width:"calc(100% - ".concat(scrollBarSize,"px)"),overflow:"hidden",overflowX:"hidden",overflowY:"hidden"},{element:container})),!scrollingEffectClassNameReg.test(containerClassName)){var addClassName="".concat(containerClassName," ").concat(scrollingEffectClassName);container.className=addClassName.trim()}locks=[].concat(_toConsumableArray(locks),[{target:_this.lockTarget,options:_this.options}])}},this.unLock=function(){var _this$options5,findLock=locks.find(function(_ref5){var target=_ref5.target;return target===_this.lockTarget});if(locks=locks.filter(function(_ref6){var target=_ref6.target;return target!==_this.lockTarget}),findLock&&!locks.some(function(_ref7){var _findLock$options,options=_ref7.options;return(null===options||void 0===options?void 0:options.container)===(null===(_findLock$options=findLock.options)||void 0===_findLock$options?void 0:_findLock$options.container)})){var container=(null===(_this$options5=_this.options)||void 0===_this$options5?void 0:_this$options5.container)||document.body,containerClassName=container.className;scrollingEffectClassNameReg.test(containerClassName)&&(setStyle(cacheStyle.get(container),{element:container}),cacheStyle.delete(container),container.className=container.className.replace(scrollingEffectClassNameReg,"").trim())}},this.lockTarget=uuid++,this.options=options};export{ScrollLocker as default};