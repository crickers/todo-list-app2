import"/node_modules/core-js/modules/es.regexp.to-string.js";import _classCallCheck from"/node_modules/@babel/runtime/helpers/esm/classCallCheck.js";import _createClass from"/node_modules/@babel/runtime/helpers/esm/createClass.js";import _inherits from"/node_modules/@babel/runtime/helpers/esm/inherits.js";import _possibleConstructorReturn from"/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js";import _getPrototypeOf from"/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js";import _typeof from"/node_modules/@babel/runtime/helpers/esm/typeof.js";function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}import React from"c:\\node_modules\\react\\index.js";import raf from"/node_modules/rc-util/es/raf.js";import Portal from"/node_modules/rc-util/es/Portal.js";import canUseDom from"/node_modules/rc-util/es/Dom/canUseDom.js";import switchScrollingEffect from"/node_modules/rc-util/es/switchScrollingEffect.js";import setStyle from"/node_modules/rc-util/es/setStyle.js";import ScrollLocker from"/node_modules/rc-util/es/Dom/scrollLocker.js";var openCount=0,supportDom=canUseDom();export function getOpenCount(){return 0}var cacheOverflow={},getParent=function getParent(getContainer){if(!supportDom)return null;if(getContainer){if("string"==typeof getContainer)return document.querySelectorAll(getContainer)[0];if("function"==typeof getContainer)return getContainer();if("object"===_typeof(getContainer)&&getContainer instanceof window.HTMLElement)return getContainer}return document.body},PortalWrapper=function(_React$Component){function PortalWrapper(props){var _this;return _classCallCheck(this,PortalWrapper),_this=_super.call(this,props),_this.componentRef=React.createRef(),_this.updateScrollLocker=function(prevProps){var prevVisible=(prevProps||{}).visible,_this$props=_this.props,getContainer=_this$props.getContainer,visible=_this$props.visible;visible&&visible!==prevVisible&&supportDom&&getParent(getContainer)!==_this.scrollLocker.getContainer()&&_this.scrollLocker.reLock({container:getParent(getContainer)})},_this.updateOpenCount=function(prevProps){var _ref2=prevProps||{},prevVisible=_ref2.visible,prevGetContainer=_ref2.getContainer,_this$props2=_this.props,visible=_this$props2.visible,getContainer=_this$props2.getContainer;visible!==prevVisible&&supportDom&&getParent(getContainer)===document.body&&(visible&&!prevVisible?openCount+=1:prevProps&&(openCount-=1)),("function"==typeof getContainer&&"function"==typeof prevGetContainer?getContainer.toString()!==prevGetContainer.toString():getContainer!==prevGetContainer)&&_this.removeCurrentContainer()},_this.attachToParent=function(){var force=!!(0<arguments.length&&void 0!==arguments[0])&&arguments[0];if(force||_this.container&&!_this.container.parentNode){var parent=getParent(_this.props.getContainer);return!!parent&&(parent.appendChild(_this.container),!0)}return!0},_this.getContainer=function(){return supportDom?(_this.container||(_this.container=document.createElement("div"),_this.attachToParent(!0)),_this.setWrapperClassName(),_this.container):null},_this.setWrapperClassName=function(){var wrapperClassName=_this.props.wrapperClassName;_this.container&&wrapperClassName&&wrapperClassName!==_this.container.className&&(_this.container.className=wrapperClassName)},_this.removeCurrentContainer=function(){var _this$container,_this$container$paren;null===(_this$container=_this.container)||void 0===_this$container||null===(_this$container$paren=_this$container.parentNode)||void 0===_this$container$paren?void 0:_this$container$paren.removeChild(_this.container)},_this.switchScrollingEffect=function(){1!==openCount||Object.keys(cacheOverflow).length?!openCount&&(setStyle(cacheOverflow),cacheOverflow={},switchScrollingEffect(!0)):(switchScrollingEffect(),cacheOverflow=setStyle({overflow:"hidden",overflowX:"hidden",overflowY:"hidden"}))},_this.scrollLocker=new ScrollLocker({container:getParent(props.getContainer)}),_this}_inherits(PortalWrapper,_React$Component);var _super=_createSuper(PortalWrapper);return _createClass(PortalWrapper,[{key:"componentDidMount",value:function componentDidMount(){var _this2=this;this.updateOpenCount(),this.attachToParent()||(this.rafId=raf(function(){_this2.forceUpdate()}))}},{key:"componentDidUpdate",value:function componentDidUpdate(prevProps){this.updateOpenCount(prevProps),this.updateScrollLocker(prevProps),this.setWrapperClassName(),this.attachToParent()}},{key:"componentWillUnmount",value:function componentWillUnmount(){var _this$props3=this.props,visible=_this$props3.visible,getContainer=_this$props3.getContainer;supportDom&&getParent(getContainer)===document.body&&(openCount=visible&&openCount?openCount-1:openCount),this.removeCurrentContainer(),raf.cancel(this.rafId)}},{key:"render",value:function render(){var _this$props4=this.props,children=_this$props4.children,forceRender=_this$props4.forceRender,visible=_this$props4.visible,portal=null,childProps={getOpenCount:function getOpenCount(){return openCount},getContainer:this.getContainer,switchScrollingEffect:this.switchScrollingEffect,scrollLocker:this.scrollLocker};return(forceRender||visible||this.componentRef.current)&&(portal=React.createElement(Portal,{getContainer:this.getContainer,ref:this.componentRef},children(childProps))),portal}}]),PortalWrapper}(React.Component);export default PortalWrapper;