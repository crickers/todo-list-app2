import"/node_modules/core-js/modules/es.array.index-of.js";import"/node_modules/core-js/modules/es.array.slice.js";import"/node_modules/core-js/modules/es.array.splice.js";import"/node_modules/core-js/modules/es.object.assign.js";import _objectWithoutProperties from"/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js";import _toConsumableArray from"/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js";import _classCallCheck from"/node_modules/@babel/runtime/helpers/esm/classCallCheck.js";import _createClass from"/node_modules/@babel/runtime/helpers/esm/createClass.js";import _inherits from"/node_modules/@babel/runtime/helpers/esm/inherits.js";import _createSuper from"/node_modules/@babel/runtime/helpers/esm/createSuper.js";import React from"c:\\node_modules\\react\\index.js";import Trigger from"/node_modules/rc-trigger.js";import warning from"/node_modules/warning.js";import KeyCode from"/node_modules/rc-util/es/KeyCode.js";import arrayTreeFilter from"/node_modules/array-tree-filter.js";import{isEqualArrays}from"/node_modules/rc-cascader/es/utils.js";import Menus from"/node_modules/rc-cascader/es/Menus.js";import BUILT_IN_PLACEMENTS from"/node_modules/rc-cascader/es/placements.js";var Cascader=function(_React$Component){function Cascader(props){var _this;_classCallCheck(this,Cascader),_this=_super.call(this,props),_this.setPopupVisible=function(popupVisible){var value=_this.state.value;"popupVisible"in _this.props||_this.setState({popupVisible:popupVisible}),popupVisible&&!_this.state.popupVisible&&_this.setState({activeValue:value}),_this.props.onPopupVisibleChange(popupVisible)},_this.handleChange=function(options,_ref,e){var visible=_ref.visible;("keydown"!==e.type||e.keyCode===KeyCode.ENTER)&&(_this.props.onChange(options.map(function(o){return o[_this.getFieldName("value")]}),options),_this.setPopupVisible(visible))},_this.handlePopupVisibleChange=function(popupVisible){_this.setPopupVisible(popupVisible)},_this.handleMenuSelect=function(targetOption,menuIndex,e){var triggerNode=_this.trigger.getRootDomNode();triggerNode&&triggerNode.focus&&triggerNode.focus();var _this$props=_this.props,changeOnSelect=_this$props.changeOnSelect,loadData=_this$props.loadData,expandTrigger=_this$props.expandTrigger;if(targetOption&&!targetOption.disabled){var activeValue=_this.state.activeValue;activeValue=activeValue.slice(0,menuIndex+1),activeValue[menuIndex]=targetOption[_this.getFieldName("value")];var activeOptions=_this.getActiveOptions(activeValue);if(!1===targetOption.isLeaf&&!targetOption[_this.getFieldName("children")]&&loadData)return changeOnSelect&&_this.handleChange(activeOptions,{visible:!0},e),_this.setState({activeValue:activeValue}),void loadData(activeOptions);var newState={};targetOption[_this.getFieldName("children")]&&targetOption[_this.getFieldName("children")].length?changeOnSelect&&("click"===e.type||"keydown"===e.type)&&("hover"===expandTrigger?_this.handleChange(activeOptions,{visible:!1},e):_this.handleChange(activeOptions,{visible:!0},e),newState.value=activeValue):(_this.handleChange(activeOptions,{visible:!1},e),newState.value=activeValue),newState.activeValue=activeValue,("value"in _this.props||"keydown"===e.type&&e.keyCode!==KeyCode.ENTER)&&delete newState.value,_this.setState(newState)}},_this.handleItemDoubleClick=function(){var changeOnSelect=_this.props.changeOnSelect;changeOnSelect&&_this.setPopupVisible(!1)},_this.handleKeyDown=function(e){var children=_this.props.children;if(children&&children.props.onKeyDown)return void children.props.onKeyDown(e);var activeValue=_toConsumableArray(_this.state.activeValue),currentLevel=0>activeValue.length-1?0:activeValue.length-1,currentOptions=_this.getCurrentLevelOptions(),currentIndex=currentOptions.map(function(o){return o[_this.getFieldName("value")]}).indexOf(activeValue[currentLevel]);if(e.keyCode===KeyCode.DOWN||e.keyCode===KeyCode.UP||e.keyCode===KeyCode.LEFT||e.keyCode===KeyCode.RIGHT||e.keyCode===KeyCode.ENTER||e.keyCode===KeyCode.SPACE||e.keyCode===KeyCode.BACKSPACE||e.keyCode===KeyCode.ESC||e.keyCode===KeyCode.TAB){if(!_this.state.popupVisible&&e.keyCode!==KeyCode.BACKSPACE&&e.keyCode!==KeyCode.LEFT&&e.keyCode!==KeyCode.RIGHT&&e.keyCode!==KeyCode.ESC&&e.keyCode!==KeyCode.TAB)return _this.setPopupVisible(!0),void(_this.props.onKeyDown&&_this.props.onKeyDown(e));if(e.keyCode===KeyCode.DOWN||e.keyCode===KeyCode.UP){e.preventDefault();var nextIndex=currentIndex;-1===nextIndex?nextIndex=0:e.keyCode===KeyCode.DOWN?(nextIndex+=1,nextIndex=nextIndex>=currentOptions.length?0:nextIndex):(nextIndex-=1,nextIndex=0>nextIndex?currentOptions.length-1:nextIndex),activeValue[currentLevel]=currentOptions[nextIndex][_this.getFieldName("value")]}else if(e.keyCode===KeyCode.LEFT||e.keyCode===KeyCode.BACKSPACE)e.preventDefault(),activeValue.splice(activeValue.length-1,1);else if(e.keyCode===KeyCode.RIGHT)e.preventDefault(),currentOptions[currentIndex]&&currentOptions[currentIndex][_this.getFieldName("children")]&&activeValue.push(currentOptions[currentIndex][_this.getFieldName("children")][0][_this.getFieldName("value")]);else if(e.keyCode===KeyCode.ESC||e.keyCode===KeyCode.TAB)return _this.setPopupVisible(!1),void(_this.props.onKeyDown&&_this.props.onKeyDown(e));activeValue&&0!==activeValue.length||_this.setPopupVisible(!1);var activeOptions=_this.getActiveOptions(activeValue),targetOption=activeOptions[activeOptions.length-1];_this.handleMenuSelect(targetOption,activeOptions.length-1,e),_this.props.onKeyDown&&_this.props.onKeyDown(e)}},_this.saveTrigger=function(node){_this.trigger=node};var initialValue=[];return"value"in props?initialValue=props.value||[]:"defaultValue"in props&&(initialValue=props.defaultValue||[]),warning(!("filedNames"in props),"`filedNames` of Cascader is a typo usage and deprecated, please use `fieldNames` instead."),_this.state={popupVisible:props.popupVisible,activeValue:initialValue,value:initialValue,prevProps:props},_this.defaultFieldNames={label:"label",value:"value",children:"children"},_this}_inherits(Cascader,_React$Component);var _super=_createSuper(Cascader);return _createClass(Cascader,[{key:"getPopupDOMNode",value:function getPopupDOMNode(){return this.trigger.getPopupDomNode()}},{key:"getFieldName",value:function getFieldName(name){var defaultFieldNames=this.defaultFieldNames,_this$props2=this.props,fieldNames=_this$props2.fieldNames,filedNames=_this$props2.filedNames;return"filedNames"in this.props?filedNames[name]||defaultFieldNames[name]:fieldNames[name]||defaultFieldNames[name]}},{key:"getFieldNames",value:function getFieldNames(){var _this$props3=this.props,fieldNames=_this$props3.fieldNames,filedNames=_this$props3.filedNames;return"filedNames"in this.props?filedNames:fieldNames}},{key:"getCurrentLevelOptions",value:function getCurrentLevelOptions(){var _this2=this,_this$props$options=this.props.options,options=void 0===_this$props$options?[]:_this$props$options,_this$state$activeVal=this.state.activeValue,activeValue=void 0===_this$state$activeVal?[]:_this$state$activeVal,result=arrayTreeFilter(options,function(o,level){return o[_this2.getFieldName("value")]===activeValue[level]},{childrenKeyName:this.getFieldName("children")});return result[result.length-2]?result[result.length-2][this.getFieldName("children")]:_toConsumableArray(options).filter(function(o){return!o.disabled})}},{key:"getActiveOptions",value:function getActiveOptions(activeValue){var _this3=this;return arrayTreeFilter(this.props.options||[],function(o,level){return o[_this3.getFieldName("value")]===activeValue[level]},{childrenKeyName:this.getFieldName("children")})}},{key:"render",value:function render(){var _this$props4=this.props,prefixCls=_this$props4.prefixCls,transitionName=_this$props4.transitionName,popupClassName=_this$props4.popupClassName,_this$props4$options=_this$props4.options,options=void 0===_this$props4$options?[]:_this$props4$options,disabled=_this$props4.disabled,builtinPlacements=_this$props4.builtinPlacements,popupPlacement=_this$props4.popupPlacement,children=_this$props4.children,dropdownRender=_this$props4.dropdownRender,restProps=_objectWithoutProperties(_this$props4,["prefixCls","transitionName","popupClassName","options","disabled","builtinPlacements","popupPlacement","children","dropdownRender"]),menus=React.createElement("div",null),emptyMenuClassName="";options&&0<options.length?menus=React.createElement(Menus,Object.assign({},this.props,{fieldNames:this.getFieldNames(),defaultFieldNames:this.defaultFieldNames,activeValue:this.state.activeValue,onSelect:this.handleMenuSelect,onItemDoubleClick:this.handleItemDoubleClick,visible:this.state.popupVisible})):emptyMenuClassName=" ".concat(prefixCls,"-menus-empty");var popupNode=menus;return dropdownRender&&(popupNode=dropdownRender(menus)),React.createElement(Trigger,Object.assign({ref:this.saveTrigger},restProps,{popupPlacement:popupPlacement,builtinPlacements:builtinPlacements,popupTransitionName:transitionName,action:disabled?[]:["click"],popupVisible:!disabled&&this.state.popupVisible,onPopupVisibleChange:this.handlePopupVisibleChange,prefixCls:"".concat(prefixCls,"-menus"),popupClassName:popupClassName+emptyMenuClassName,popup:popupNode}),React.cloneElement(children,{onKeyDown:this.handleKeyDown,tabIndex:disabled?void 0:0}))}}],[{key:"getDerivedStateFromProps",value:function getDerivedStateFromProps(nextProps,prevState){var _prevState$prevProps=prevState.prevProps,prevProps=void 0===_prevState$prevProps?{}:_prevState$prevProps,newState={prevProps:nextProps};return"value"in nextProps&&!isEqualArrays(prevProps.value,nextProps.value)&&(newState.value=nextProps.value||[],!("loadData"in nextProps)&&(newState.activeValue=nextProps.value||[])),"popupVisible"in nextProps&&(newState.popupVisible=nextProps.popupVisible),newState}}]),Cascader}(React.Component);Cascader.defaultProps={onChange:function onChange(){},onPopupVisibleChange:function onPopupVisibleChange(){},disabled:!1,transitionName:"",prefixCls:"rc-cascader",popupClassName:"",popupPlacement:"bottomLeft",builtinPlacements:BUILT_IN_PLACEMENTS,expandTrigger:"click",fieldNames:{label:"label",value:"value",children:"children"},expandIcon:">"};export default Cascader;