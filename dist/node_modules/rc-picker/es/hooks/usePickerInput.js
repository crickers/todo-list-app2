import"/node_modules/core-js/modules/es.string.includes.js";import _slicedToArray from"/node_modules/@babel/runtime/helpers/esm/slicedToArray.js";import{useState,useEffect,useRef}from"c:\\node_modules\\react\\index.js";import KeyCode from"/node_modules/rc-util/es/KeyCode.js";import{addGlobalMouseDownEvent}from"/node_modules/rc-picker/es/utils/uiUtil.js";export default function usePickerInput(_ref){var open=_ref.open,value=_ref.value,isClickOutside=_ref.isClickOutside,triggerOpen=_ref.triggerOpen,forwardKeyDown=_ref.forwardKeyDown,_onKeyDown=_ref.onKeyDown,blurToCancel=_ref.blurToCancel,onSubmit=_ref.onSubmit,onCancel=_ref.onCancel,_onFocus=_ref.onFocus,_onBlur=_ref.onBlur,_useState=useState(!1),_useState2=_slicedToArray(_useState,2),typing=_useState2[0],setTyping=_useState2[1],_useState3=useState(!1),_useState4=_slicedToArray(_useState3,2),focused=_useState4[0],setFocused=_useState4[1],preventBlurRef=useRef(!1),valueChangedRef=useRef(!1),preventDefaultRef=useRef(!1);return useEffect(function(){valueChangedRef.current=!1},[open]),useEffect(function(){valueChangedRef.current=!0},[value]),useEffect(function(){return addGlobalMouseDownEvent(function(_ref2){var target=_ref2.target;open&&(isClickOutside(target)?!focused&&triggerOpen(!1):(preventBlurRef.current=!0,requestAnimationFrame(function(){preventBlurRef.current=!1})))})}),[{onMouseDown:function onMouseDown(){setTyping(!0),triggerOpen(!0)},onKeyDown:function onKeyDown(e){if(_onKeyDown(e,function preventDefault(){preventDefaultRef.current=!0}),!preventDefaultRef.current){switch(e.which){case KeyCode.ENTER:return open?!1!==onSubmit()&&setTyping(!0):triggerOpen(!0),void e.preventDefault();case KeyCode.TAB:return void(typing&&open&&!e.shiftKey?(setTyping(!1),e.preventDefault()):!typing&&open&&!forwardKeyDown(e)&&e.shiftKey&&(setTyping(!0),e.preventDefault()));case KeyCode.ESC:return setTyping(!0),void onCancel();}open||[KeyCode.SHIFT].includes(e.which)?!typing&&forwardKeyDown(e):triggerOpen(!0)}},onFocus:function onFocus(e){setTyping(!0),setFocused(!0),_onFocus&&_onFocus(e)},onBlur:function onBlur(e){return preventBlurRef.current||!isClickOutside(document.activeElement)?void(preventBlurRef.current=!1):void(blurToCancel?setTimeout(function(){isClickOutside(document.activeElement)&&onCancel()},0):open&&(triggerOpen(!1),valueChangedRef.current&&onSubmit()),setFocused(!1),_onBlur&&_onBlur(e))}},{focused:focused,typing:typing}]}