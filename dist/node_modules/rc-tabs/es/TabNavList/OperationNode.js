import"/node_modules/core-js/modules/es.string.includes.js";import _defineProperty from"/node_modules/@babel/runtime/helpers/esm/defineProperty.js";import _slicedToArray from"/node_modules/@babel/runtime/helpers/esm/slicedToArray.js";import React from"c:\\node_modules\\react\\index.js";import classNames from"/node_modules/classnames.js";import{useState,useEffect}from"c:\\node_modules\\react\\index.js";import KeyCode from"/node_modules/rc-util/es/KeyCode.js";import Menu,{MenuItem}from"/node_modules/rc-menu.js";import Dropdown from"/node_modules/rc-dropdown.js";import AddButton from"/node_modules/rc-tabs/es/TabNavList/AddButton.js";function OperationNode(_ref,ref){function selectOffset(offset){for(var enabledTabs=tabs.filter(function(tab){return!tab.disabled}),selectedIndex=enabledTabs.findIndex(function(tab){return tab.key===selectedKey})||0,len=enabledTabs.length,i=0;i<len;i+=1){selectedIndex=(selectedIndex+offset+len)%len;var tab=enabledTabs[selectedIndex];if(!tab.disabled)return void setSelectedKey(tab.key)}}var prefixCls=_ref.prefixCls,id=_ref.id,tabs=_ref.tabs,locale=_ref.locale,mobile=_ref.mobile,_ref$moreIcon=_ref.moreIcon,moreIcon=void 0===_ref$moreIcon?"More":_ref$moreIcon,moreTransitionName=_ref.moreTransitionName,style=_ref.style,className=_ref.className,editable=_ref.editable,tabBarGutter=_ref.tabBarGutter,rtl=_ref.rtl,onTabClick=_ref.onTabClick,_useState=useState(!1),_useState2=_slicedToArray(_useState,2),open=_useState2[0],setOpen=_useState2[1],_useState3=useState(null),_useState4=_slicedToArray(_useState3,2),selectedKey=_useState4[0],setSelectedKey=_useState4[1],popupId="".concat(id,"-more-popup"),dropdownPrefix="".concat(prefixCls,"-dropdown"),selectedItemId=null===selectedKey?null:"".concat(popupId,"-").concat(selectedKey),dropdownAriaLabel=null===locale||void 0===locale?void 0:locale.dropdownAriaLabel,menu=React.createElement(Menu,{onClick:function onClick(_ref2){var key=_ref2.key,domEvent=_ref2.domEvent;onTabClick(key,domEvent),setOpen(!1)},id:popupId,tabIndex:-1,role:"listbox","aria-activedescendant":selectedItemId,selectedKeys:[selectedKey],"aria-label":void 0===dropdownAriaLabel?"expanded dropdown":dropdownAriaLabel},tabs.map(function(tab){return React.createElement(MenuItem,{key:tab.key,id:"".concat(popupId,"-").concat(tab.key),role:"option","aria-controls":id&&"".concat(id,"-panel-").concat(tab.key),disabled:tab.disabled},tab.tab)}));useEffect(function(){var ele=document.getElementById(selectedItemId);ele&&ele.scrollIntoView&&ele.scrollIntoView(!1)},[selectedKey]),useEffect(function(){open||setSelectedKey(null)},[open]);var moreStyle=_defineProperty({},rtl?"marginLeft":"marginRight",tabBarGutter);tabs.length||(moreStyle.visibility="hidden",moreStyle.order=1);var overlayClassName=classNames(_defineProperty({},"".concat(dropdownPrefix,"-rtl"),rtl)),moreNode=mobile?null:React.createElement(Dropdown,{prefixCls:dropdownPrefix,overlay:menu,trigger:["hover"],visible:open,transitionName:moreTransitionName,onVisibleChange:setOpen,overlayClassName:overlayClassName,mouseEnterDelay:.1,mouseLeaveDelay:.1},React.createElement("button",{type:"button",className:"".concat(prefixCls,"-nav-more"),style:moreStyle,tabIndex:-1,"aria-hidden":"true","aria-haspopup":"listbox","aria-controls":popupId,id:"".concat(id,"-more"),"aria-expanded":open,onKeyDown:function onKeyDown(e){var which=e.which;if(!open)return void([KeyCode.DOWN,KeyCode.SPACE,KeyCode.ENTER].includes(which)&&(setOpen(!0),e.preventDefault()));which===KeyCode.UP?(selectOffset(-1),e.preventDefault()):which===KeyCode.DOWN?(selectOffset(1),e.preventDefault()):which===KeyCode.ESC?setOpen(!1):which===KeyCode.SPACE||which===KeyCode.ENTER?null!==selectedKey&&onTabClick(selectedKey,e):void 0}},moreIcon));return React.createElement("div",{className:classNames("".concat(prefixCls,"-nav-operations"),className),style:style,ref:ref},moreNode,React.createElement(AddButton,{prefixCls:prefixCls,locale:locale,editable:editable}))}export default React.forwardRef(OperationNode);