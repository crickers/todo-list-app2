import"/node_modules/core-js/modules/es.array.iterator.js";import"/node_modules/core-js/modules/es.array.slice.js";import"/node_modules/core-js/modules/es.string.includes.js";import"/node_modules/core-js/modules/esnext.map.delete-all.js";import"/node_modules/core-js/modules/esnext.map.every.js";import"/node_modules/core-js/modules/esnext.map.filter.js";import"/node_modules/core-js/modules/esnext.map.find.js";import"/node_modules/core-js/modules/esnext.map.find-key.js";import"/node_modules/core-js/modules/esnext.map.includes.js";import"/node_modules/core-js/modules/esnext.map.key-of.js";import"/node_modules/core-js/modules/esnext.map.map-keys.js";import"/node_modules/core-js/modules/esnext.map.map-values.js";import"/node_modules/core-js/modules/esnext.map.merge.js";import"/node_modules/core-js/modules/esnext.map.reduce.js";import"/node_modules/core-js/modules/esnext.map.some.js";import"/node_modules/core-js/modules/esnext.map.update.js";import"/node_modules/core-js/modules/web.dom-collections.iterator.js";import _extends from"/node_modules/@babel/runtime/helpers/esm/extends.js";import _defineProperty from"/node_modules/@babel/runtime/helpers/esm/defineProperty.js";import _toConsumableArray from"/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js";import _objectSpread from"/node_modules/@babel/runtime/helpers/esm/objectSpread2.js";import _slicedToArray from"/node_modules/@babel/runtime/helpers/esm/slicedToArray.js";import React from"c:\\node_modules\\react\\index.js";import{useState,useRef,useEffect}from"c:\\node_modules\\react\\index.js";import classNames from"/node_modules/classnames.js";import raf from"/node_modules/rc-util/es/raf.js";import ResizeObserver from"/node_modules/rc-resize-observer.js";import useRaf,{useRafState}from"/node_modules/rc-tabs/es/hooks/useRaf.js";import TabNode from"/node_modules/rc-tabs/es/TabNavList/TabNode.js";import useOffsets from"/node_modules/rc-tabs/es/hooks/useOffsets.js";import useVisibleRange from"/node_modules/rc-tabs/es/hooks/useVisibleRange.js";import OperationNode from"/node_modules/rc-tabs/es/TabNavList/OperationNode.js";import TabContext from"/node_modules/rc-tabs/es/TabContext.js";import useTouchMove from"/node_modules/rc-tabs/es/hooks/useTouchMove.js";import useRefs from"/node_modules/rc-tabs/es/hooks/useRefs.js";import AddButton from"/node_modules/rc-tabs/es/TabNavList/AddButton.js";import useSyncState from"/node_modules/rc-tabs/es/hooks/useSyncState.js";var ExtraContent=function ExtraContent(_ref){var position=_ref.position,prefixCls=_ref.prefixCls,extra=_ref.extra;if(!extra)return null;var content,assertExtra=extra;return"right"===position&&(content=assertExtra.right||!assertExtra.left&&assertExtra||null),"left"===position&&(content=assertExtra.left||null),content?React.createElement("div",{className:"".concat(prefixCls,"-extra-content")},content):null};function TabNavList(props,ref){function alignInRange(value){return value<transformMin?transformMin:value>transformMax?transformMax:value}function doLockAnimation(){setLockAnimation(Date.now())}function clearTouchMoving(){window.clearTimeout(touchMovingRef.current)}function scrollToTab(){var key=0<arguments.length&&void 0!==arguments[0]?arguments[0]:activeKey,tabOffset=tabOffsets.get(key)||{width:0,height:0,left:0,right:0,top:0};if(tabPositionTopOrBottom){var newTransform=transformLeft;rtl?tabOffset.right<transformLeft?newTransform=tabOffset.right:tabOffset.right+tabOffset.width>transformLeft+wrapperWidth&&(newTransform=tabOffset.right+tabOffset.width-wrapperWidth):tabOffset.left<-transformLeft?newTransform=-tabOffset.left:tabOffset.left+tabOffset.width>-transformLeft+wrapperWidth&&(newTransform=-(tabOffset.left+tabOffset.width-wrapperWidth)),setTransformTop(0),setTransformLeft(alignInRange(newTransform))}else{var _newTransform=transformTop;tabOffset.top<-transformTop?_newTransform=-tabOffset.top:tabOffset.top+tabOffset.height>-transformTop+wrapperHeight&&(_newTransform=-(tabOffset.top+tabOffset.height-wrapperHeight)),setTransformLeft(0),setTransformTop(alignInRange(_newTransform))}}function cleanInkBarRaf(){raf.cancel(inkBarRafRef.current)}var _classNames,_React$useContext=React.useContext(TabContext),prefixCls=_React$useContext.prefixCls,tabs=_React$useContext.tabs,className=props.className,style=props.style,id=props.id,animated=props.animated,activeKey=props.activeKey,rtl=props.rtl,extra=props.extra,editable=props.editable,locale=props.locale,tabPosition=props.tabPosition,tabBarGutter=props.tabBarGutter,children=props.children,onTabClick=props.onTabClick,onTabScroll=props.onTabScroll,tabsWrapperRef=useRef(),tabListRef=useRef(),operationsRef=useRef(),innerAddButtonRef=useRef(),_useRefs=useRefs(),_useRefs2=_slicedToArray(_useRefs,2),getBtnRef=_useRefs2[0],removeBtnRef=_useRefs2[1],tabPositionTopOrBottom="top"===tabPosition||"bottom"===tabPosition,_useSyncState=useSyncState(0,function(next,prev){tabPositionTopOrBottom&&onTabScroll&&onTabScroll({direction:next>prev?"left":"right"})}),_useSyncState2=_slicedToArray(_useSyncState,2),transformLeft=_useSyncState2[0],setTransformLeft=_useSyncState2[1],_useSyncState3=useSyncState(0,function(next,prev){!tabPositionTopOrBottom&&onTabScroll&&onTabScroll({direction:next>prev?"top":"bottom"})}),_useSyncState4=_slicedToArray(_useSyncState3,2),transformTop=_useSyncState4[0],setTransformTop=_useSyncState4[1],_useState=useState(0),_useState2=_slicedToArray(_useState,2),wrapperScrollWidth=_useState2[0],setWrapperScrollWidth=_useState2[1],_useState3=useState(0),_useState4=_slicedToArray(_useState3,2),wrapperScrollHeight=_useState4[0],setWrapperScrollHeight=_useState4[1],_useState5=useState(0),_useState6=_slicedToArray(_useState5,2),wrapperContentWidth=_useState6[0],setWrapperContentWidth=_useState6[1],_useState7=useState(0),_useState8=_slicedToArray(_useState7,2),wrapperContentHeight=_useState8[0],setWrapperContentHeight=_useState8[1],_useState9=useState(null),_useState10=_slicedToArray(_useState9,2),wrapperWidth=_useState10[0],setWrapperWidth=_useState10[1],_useState11=useState(null),_useState12=_slicedToArray(_useState11,2),wrapperHeight=_useState12[0],setWrapperHeight=_useState12[1],_useState13=useState(0),_useState14=_slicedToArray(_useState13,2),addWidth=_useState14[0],setAddWidth=_useState14[1],_useState15=useState(0),_useState16=_slicedToArray(_useState15,2),addHeight=_useState16[0],setAddHeight=_useState16[1],_useRafState=useRafState(new Map),_useRafState2=_slicedToArray(_useRafState,2),tabSizes=_useRafState2[0],setTabSizes=_useRafState2[1],tabOffsets=useOffsets(tabs,tabSizes,wrapperScrollWidth),operationsHiddenClassName="".concat(prefixCls,"-nav-operations-hidden"),transformMin=0,transformMax=0;tabPositionTopOrBottom?rtl?(transformMin=0,transformMax=Math.max(0,wrapperScrollWidth-wrapperWidth)):(transformMin=Math.min(0,wrapperWidth-wrapperScrollWidth),transformMax=0):(transformMin=Math.min(0,wrapperHeight-wrapperScrollHeight),transformMax=0);var touchMovingRef=useRef(),_useState17=useState(),_useState18=_slicedToArray(_useState17,2),lockAnimation=_useState18[0],setLockAnimation=_useState18[1];useTouchMove(tabsWrapperRef,function(offsetX,offsetY){function doMove(setState,offset){setState(function(value){var newValue=alignInRange(value+offset);return newValue})}if(tabPositionTopOrBottom){if(wrapperWidth>=wrapperScrollWidth)return!1;doMove(setTransformLeft,offsetX)}else{if(wrapperHeight>=wrapperScrollHeight)return!1;doMove(setTransformTop,offsetY)}return clearTouchMoving(),doLockAnimation(),!0}),useEffect(function(){return clearTouchMoving(),lockAnimation&&(touchMovingRef.current=window.setTimeout(function(){setLockAnimation(0)},100)),clearTouchMoving},[lockAnimation]);var _useVisibleRange=useVisibleRange(tabOffsets,{width:wrapperWidth,height:wrapperHeight,left:transformLeft,top:transformTop},{width:wrapperContentWidth,height:wrapperContentHeight},{width:addWidth,height:addHeight},_objectSpread(_objectSpread({},props),{},{tabs:tabs})),_useVisibleRange2=_slicedToArray(_useVisibleRange,2),visibleStart=_useVisibleRange2[0],visibleEnd=_useVisibleRange2[1],tabNodes=tabs.map(function(tab){var key=tab.key;return React.createElement(TabNode,{id:id,prefixCls:prefixCls,key:key,rtl:rtl,tab:tab,closable:tab.closable,editable:editable,active:key===activeKey,tabPosition:tabPosition,tabBarGutter:tabBarGutter,renderWrapper:children,removeAriaLabel:null===locale||void 0===locale?void 0:locale.removeAriaLabel,ref:getBtnRef(key),onClick:function onClick(e){onTabClick(key,e)},onRemove:function onRemove(){removeBtnRef(key)},onFocus:function onFocus(){scrollToTab(key),doLockAnimation(),rtl||(tabsWrapperRef.current.scrollLeft=0),tabsWrapperRef.current.scrollTop=0}})}),onListHolderResize=useRaf(function(){var _tabsWrapperRef$curre,_tabsWrapperRef$curre2,_innerAddButtonRef$cu,_innerAddButtonRef$cu2,_operationsRef$curren,_operationsRef$curren2,_tabListRef$current,_tabListRef$current2,_operationsRef$curren3,offsetWidth=(null===(_tabsWrapperRef$curre=tabsWrapperRef.current)||void 0===_tabsWrapperRef$curre?void 0:_tabsWrapperRef$curre.offsetWidth)||0,offsetHeight=(null===(_tabsWrapperRef$curre2=tabsWrapperRef.current)||void 0===_tabsWrapperRef$curre2?void 0:_tabsWrapperRef$curre2.offsetHeight)||0,newAddWidth=(null===(_innerAddButtonRef$cu=innerAddButtonRef.current)||void 0===_innerAddButtonRef$cu?void 0:_innerAddButtonRef$cu.offsetWidth)||0,newAddHeight=(null===(_innerAddButtonRef$cu2=innerAddButtonRef.current)||void 0===_innerAddButtonRef$cu2?void 0:_innerAddButtonRef$cu2.offsetHeight)||0,newOperationWidth=(null===(_operationsRef$curren=operationsRef.current)||void 0===_operationsRef$curren?void 0:_operationsRef$curren.offsetWidth)||0,newOperationHeight=(null===(_operationsRef$curren2=operationsRef.current)||void 0===_operationsRef$curren2?void 0:_operationsRef$curren2.offsetHeight)||0;setWrapperWidth(offsetWidth),setWrapperHeight(offsetHeight),setAddWidth(newAddWidth),setAddHeight(newAddHeight);var newWrapperScrollWidth=((null===(_tabListRef$current=tabListRef.current)||void 0===_tabListRef$current?void 0:_tabListRef$current.offsetWidth)||0)-newAddWidth,newWrapperScrollHeight=((null===(_tabListRef$current2=tabListRef.current)||void 0===_tabListRef$current2?void 0:_tabListRef$current2.offsetHeight)||0)-newAddHeight;setWrapperScrollWidth(newWrapperScrollWidth),setWrapperScrollHeight(newWrapperScrollHeight);var isOperationHidden=null===(_operationsRef$curren3=operationsRef.current)||void 0===_operationsRef$curren3?void 0:_operationsRef$curren3.className.includes(operationsHiddenClassName);setWrapperContentWidth(newWrapperScrollWidth-(isOperationHidden?0:newOperationWidth)),setWrapperContentHeight(newWrapperScrollHeight-(isOperationHidden?0:newOperationHeight)),setTabSizes(function(){var newSizes=new Map;return tabs.forEach(function(_ref2){var key=_ref2.key,btnNode=getBtnRef(key).current;btnNode&&newSizes.set(key,{width:btnNode.offsetWidth,height:btnNode.offsetHeight,left:btnNode.offsetLeft,top:btnNode.offsetTop})}),newSizes})}),startHiddenTabs=tabs.slice(0,visibleStart),endHiddenTabs=tabs.slice(visibleEnd+1),hiddenTabs=[].concat(_toConsumableArray(startHiddenTabs),_toConsumableArray(endHiddenTabs)),_useState19=useState(),_useState20=_slicedToArray(_useState19,2),inkStyle=_useState20[0],setInkStyle=_useState20[1],activeTabOffset=tabOffsets.get(activeKey),inkBarRafRef=useRef();useEffect(function(){var newInkStyle={};return activeTabOffset&&(tabPositionTopOrBottom?(rtl?newInkStyle.right=activeTabOffset.right:newInkStyle.left=activeTabOffset.left,newInkStyle.width=activeTabOffset.width):(newInkStyle.top=activeTabOffset.top,newInkStyle.height=activeTabOffset.height)),cleanInkBarRaf(),inkBarRafRef.current=raf(function(){setInkStyle(newInkStyle)}),cleanInkBarRaf},[activeTabOffset,tabPositionTopOrBottom,rtl]),useEffect(function(){scrollToTab()},[activeKey,activeTabOffset,tabOffsets,tabPositionTopOrBottom]),useEffect(function(){onListHolderResize()},[rtl,tabBarGutter,activeKey,tabs.map(function(tab){return tab.key}).join("_")]);var pingLeft,pingRight,pingTop,pingBottom,hasDropdown=!!hiddenTabs.length,wrapPrefix="".concat(prefixCls,"-nav-wrap");return tabPositionTopOrBottom?rtl?(pingRight=0<transformLeft,pingLeft=transformLeft+wrapperWidth<wrapperScrollWidth):(pingLeft=0>transformLeft,pingRight=-transformLeft+wrapperWidth<wrapperScrollWidth):(pingTop=0>transformTop,pingBottom=-transformTop+wrapperHeight<wrapperScrollHeight),React.createElement("div",{ref:ref,role:"tablist",className:classNames("".concat(prefixCls,"-nav"),className),style:style,onKeyDown:function onKeyDown(){doLockAnimation()}},React.createElement(ExtraContent,{position:"left",extra:extra,prefixCls:prefixCls}),React.createElement(ResizeObserver,{onResize:onListHolderResize},React.createElement("div",{className:classNames(wrapPrefix,(_classNames={},_defineProperty(_classNames,"".concat(wrapPrefix,"-ping-left"),pingLeft),_defineProperty(_classNames,"".concat(wrapPrefix,"-ping-right"),pingRight),_defineProperty(_classNames,"".concat(wrapPrefix,"-ping-top"),pingTop),_defineProperty(_classNames,"".concat(wrapPrefix,"-ping-bottom"),pingBottom),_classNames)),ref:tabsWrapperRef},React.createElement(ResizeObserver,{onResize:onListHolderResize},React.createElement("div",{ref:tabListRef,className:"".concat(prefixCls,"-nav-list"),style:{transform:"translate(".concat(transformLeft,"px, ").concat(transformTop,"px)"),transition:lockAnimation?"none":void 0}},tabNodes,React.createElement(AddButton,{ref:innerAddButtonRef,prefixCls:prefixCls,locale:locale,editable:editable,style:{visibility:hasDropdown?"hidden":null}}),React.createElement("div",{className:classNames("".concat(prefixCls,"-ink-bar"),_defineProperty({},"".concat(prefixCls,"-ink-bar-animated"),animated.inkBar)),style:inkStyle}))))),React.createElement(OperationNode,_extends({},props,{ref:operationsRef,prefixCls:prefixCls,tabs:hiddenTabs,className:!hasDropdown&&operationsHiddenClassName})),React.createElement(ExtraContent,{position:"right",extra:extra,prefixCls:prefixCls}))}export default React.forwardRef(TabNavList);