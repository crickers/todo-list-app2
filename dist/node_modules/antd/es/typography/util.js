import"/node_modules/core-js/modules/es.array.slice.js";import"/node_modules/core-js/modules/es.string.match.js";import{render,unmountComponentAtNode}from"c:\\node_modules\\react-dom\\index.js";import React from"c:\\node_modules\\react\\index.js";import toArray from"/node_modules/rc-util/es/Children/toArray.js";var ellipsisContainer,ELEMENT_NODE=1,TEXT_NODE=3,COMMENT_NODE=8,wrapperStyle={padding:0,margin:0,display:"inline",lineHeight:"inherit"};function pxToNumber(value){if(!value)return 0;var match=value.match(/^\d*(\.\d*)?/);return match?+match[0]:0}function styleToString(style){var styleNames=Array.prototype.slice.apply(style);return styleNames.map(function(name){return"".concat(name,": ").concat(style.getPropertyValue(name),";")}).join("")}function mergeChildren(children){var childList=[];return children.forEach(function(child){var prevChild=childList[childList.length-1];"string"==typeof child&&"string"==typeof prevChild?childList[childList.length-1]+=child:childList.push(child)}),childList}export default(function(originEle,option,content,fixedContent,ellipsisStr){function inRange(){return ellipsisContainer.offsetHeight<maxHeight}function appendChildNode(node){ellipsisContentHolder.insertBefore(node,ellipsisTextNode)}function measureText(textNode,fullText){var startLoc=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,endLoc=3<arguments.length&&void 0!==arguments[3]?arguments[3]:fullText.length,lastSuccessLoc=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,midLoc=Math.floor((startLoc+endLoc)/2),currentText=fullText.slice(0,midLoc);if(textNode.textContent=currentText,startLoc>=endLoc-1)for(var currentStepText,step=endLoc;step>=startLoc;step-=1)if(currentStepText=fullText.slice(0,step),textNode.textContent=currentStepText,inRange()||!currentStepText)return step===fullText.length?{finished:!1,reactNode:fullText}:{finished:!0,reactNode:currentStepText};return inRange()?measureText(textNode,fullText,midLoc,endLoc,midLoc):measureText(textNode,fullText,startLoc,midLoc,lastSuccessLoc)}function measureNode(childNode,index){var type=childNode.nodeType;if(type===ELEMENT_NODE)return(appendChildNode(childNode),inRange())?{finished:!1,reactNode:contentList[index]}:(ellipsisContentHolder.removeChild(childNode),{finished:!0,reactNode:null});if(type===TEXT_NODE){var fullText=childNode.textContent||"",textNode=document.createTextNode(fullText);return appendChildNode(textNode),measureText(textNode,fullText)}return{finished:!1,reactNode:null}}ellipsisContainer||(ellipsisContainer=document.createElement("div"),ellipsisContainer.setAttribute("aria-hidden","true"),document.body.appendChild(ellipsisContainer));var rows=option.rows,_option$suffix=option.suffix,suffix=void 0===_option$suffix?"":_option$suffix,originStyle=window.getComputedStyle(originEle),originCSS=styleToString(originStyle),lineHeight=pxToNumber(originStyle.lineHeight),maxHeight=Math.round(lineHeight*(rows+1)+pxToNumber(originStyle.paddingTop)+pxToNumber(originStyle.paddingBottom));ellipsisContainer.setAttribute("style",originCSS),ellipsisContainer.style.position="fixed",ellipsisContainer.style.left="0",ellipsisContainer.style.height="auto",ellipsisContainer.style.minHeight="auto",ellipsisContainer.style.maxHeight="auto",ellipsisContainer.style.top="-999999px",ellipsisContainer.style.zIndex="-1000",ellipsisContainer.style.textOverflow="clip",ellipsisContainer.style.whiteSpace="normal",ellipsisContainer.style.webkitLineClamp="none";var contentList=mergeChildren(toArray(content));if(render(React.createElement("div",{style:wrapperStyle},React.createElement("span",{style:wrapperStyle},contentList,suffix),React.createElement("span",{style:wrapperStyle},fixedContent)),ellipsisContainer),inRange())return unmountComponentAtNode(ellipsisContainer),{content:content,text:ellipsisContainer.innerHTML,ellipsis:!1};var childNodes=Array.prototype.slice.apply(ellipsisContainer.childNodes[0].childNodes[0].cloneNode(!0).childNodes).filter(function(_ref){var nodeType=_ref.nodeType;return nodeType!==COMMENT_NODE}),fixedNodes=Array.prototype.slice.apply(ellipsisContainer.childNodes[0].childNodes[1].cloneNode(!0).childNodes);unmountComponentAtNode(ellipsisContainer);var ellipsisChildren=[];ellipsisContainer.innerHTML="";var ellipsisContentHolder=document.createElement("span");ellipsisContainer.appendChild(ellipsisContentHolder);var ellipsisTextNode=document.createTextNode(ellipsisStr+suffix);return ellipsisContentHolder.appendChild(ellipsisTextNode),fixedNodes.forEach(function(childNode){ellipsisContainer.appendChild(childNode)}),childNodes.some(function(childNode,index){var _measureNode=measureNode(childNode,index),finished=_measureNode.finished,reactNode=_measureNode.reactNode;return reactNode&&ellipsisChildren.push(reactNode),finished}),{content:ellipsisChildren,text:ellipsisContainer.innerHTML,ellipsis:!0}});