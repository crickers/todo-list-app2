import"/node_modules/core-js/modules/es.array.index-of.js";import"/node_modules/core-js/modules/es.string.match.js";import _classCallCheck from"/node_modules/@babel/runtime/helpers/esm/classCallCheck.js";import _createClass from"/node_modules/@babel/runtime/helpers/esm/createClass.js";import _assertThisInitialized from"/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js";import _inherits from"/node_modules/@babel/runtime/helpers/esm/inherits.js";import _createSuper from"/node_modules/@babel/runtime/helpers/esm/createSuper.js";import React from"c:\\node_modules\\react\\index.js";import{supportRef,composeRef}from"/node_modules/rc-util/es/ref.js";import raf from"/node_modules/antd/es/_util/raf.js";import{ConfigConsumer,ConfigContext}from"/node_modules/antd/es/config-provider.js";import{cloneElement}from"/node_modules/antd/es/_util/reactNode.js";var styleForPseudo;function isHidden(element){return!element||null===element.offsetParent||element.hidden}function isNotGrey(color){var match=(color||"").match(/rgba?\((\d*), (\d*), (\d*)(, [\d.]*)?\)/);return!(match&&match[1]&&match[2]&&match[3])||match[1]!==match[2]||match[2]!==match[3]}var Wave=function(_React$Component){function Wave(){var _this;return _classCallCheck(this,Wave),_this=_super.apply(this,arguments),_this.containerRef=React.createRef(),_this.animationStart=!1,_this.destroyed=!1,_this.onClick=function(node,waveColor){if(!(!node||isHidden(node)||0<=node.className.indexOf("-leave"))){var insertExtraNode=_this.props.insertExtraNode;_this.extraNode=document.createElement("div");var _assertThisInitialize=_assertThisInitialized(_this),extraNode=_assertThisInitialize.extraNode,getPrefixCls=_this.context.getPrefixCls;extraNode.className="".concat(getPrefixCls(""),"-click-animating-node");var attributeName=_this.getAttributeName();node.setAttribute(attributeName,"true"),styleForPseudo=styleForPseudo||document.createElement("style"),waveColor&&"#ffffff"!==waveColor&&"rgb(255, 255, 255)"!==waveColor&&isNotGrey(waveColor)&&!/rgba\((?:\d*, ){3}0\)/.test(waveColor)&&"transparent"!==waveColor&&(_this.csp&&_this.csp.nonce&&(styleForPseudo.nonce=_this.csp.nonce),extraNode.style.borderColor=waveColor,styleForPseudo.innerHTML="\n      [".concat(getPrefixCls(""),"-click-animating-without-extra-node='true']::after, .").concat(getPrefixCls(""),"-click-animating-node {\n        --antd-wave-shadow-color: ").concat(waveColor,";\n      }"),!node.ownerDocument.body.contains(styleForPseudo)&&node.ownerDocument.body.appendChild(styleForPseudo)),insertExtraNode&&node.appendChild(extraNode),["transition","animation"].forEach(function(name){node.addEventListener("".concat(name,"start"),_this.onTransitionStart),node.addEventListener("".concat(name,"end"),_this.onTransitionEnd)})}},_this.onTransitionStart=function(e){if(!_this.destroyed){var node=_this.containerRef.current;!e||e.target!==node||_this.animationStart||_this.resetEffect(node)}},_this.onTransitionEnd=function(e){e&&"fadeEffect"===e.animationName&&_this.resetEffect(e.target)},_this.bindAnimationEvent=function(node){if(node&&node.getAttribute&&!node.getAttribute("disabled")&&!(0<=node.className.indexOf("disabled"))){var onClick=function onClick(e){if(!("INPUT"===e.target.tagName||isHidden(e.target))){_this.resetEffect(node);var waveColor=getComputedStyle(node).getPropertyValue("border-top-color")||getComputedStyle(node).getPropertyValue("border-color")||getComputedStyle(node).getPropertyValue("background-color");_this.clickWaveTimeoutId=window.setTimeout(function(){return _this.onClick(node,waveColor)},0),raf.cancel(_this.animationStartId),_this.animationStart=!0,_this.animationStartId=raf(function(){_this.animationStart=!1},10)}};return node.addEventListener("click",onClick,!0),{cancel:function cancel(){node.removeEventListener("click",onClick,!0)}}}},_this.renderWave=function(_ref){var csp=_ref.csp,children=_this.props.children;if(_this.csp=csp,!React.isValidElement(children))return children;var ref=_this.containerRef;return supportRef(children)&&(ref=composeRef(children.ref,_this.containerRef)),cloneElement(children,{ref:ref})},_this}_inherits(Wave,_React$Component);var _super=_createSuper(Wave);return _createClass(Wave,[{key:"componentDidMount",value:function componentDidMount(){var node=this.containerRef.current;node&&1===node.nodeType&&(this.instance=this.bindAnimationEvent(node))}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.instance&&this.instance.cancel(),this.clickWaveTimeoutId&&clearTimeout(this.clickWaveTimeoutId),this.destroyed=!0}},{key:"getAttributeName",value:function getAttributeName(){var getPrefixCls=this.context.getPrefixCls,insertExtraNode=this.props.insertExtraNode;return insertExtraNode?"".concat(getPrefixCls(""),"-click-animating"):"".concat(getPrefixCls(""),"-click-animating-without-extra-node")}},{key:"resetEffect",value:function resetEffect(node){var _this2=this;if(node&&node!==this.extraNode&&node instanceof Element){var insertExtraNode=this.props.insertExtraNode,attributeName=this.getAttributeName();node.setAttribute(attributeName,"false"),styleForPseudo&&(styleForPseudo.innerHTML=""),insertExtraNode&&this.extraNode&&node.contains(this.extraNode)&&node.removeChild(this.extraNode),["transition","animation"].forEach(function(name){node.removeEventListener("".concat(name,"start"),_this2.onTransitionStart),node.removeEventListener("".concat(name,"end"),_this2.onTransitionEnd)})}}},{key:"render",value:function render(){return React.createElement(ConfigConsumer,null,this.renderWave)}}]),Wave}(React.Component);export{Wave as default};Wave.contextType=ConfigContext;