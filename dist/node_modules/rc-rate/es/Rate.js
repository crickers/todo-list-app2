import _objectSpread from"/node_modules/@babel/runtime/helpers/esm/objectSpread2.js";import _defineProperty from"/node_modules/@babel/runtime/helpers/esm/defineProperty.js";import _classCallCheck from"/node_modules/@babel/runtime/helpers/esm/classCallCheck.js";import _createClass from"/node_modules/@babel/runtime/helpers/esm/createClass.js";import _inherits from"/node_modules/@babel/runtime/helpers/esm/inherits.js";import _createSuper from"/node_modules/@babel/runtime/helpers/esm/createSuper.js";import React from"c:\\node_modules\\react\\index.js";import findDOMNode from"/node_modules/rc-util/es/Dom/findDOMNode.js";import classNames from"/node_modules/classnames.js";import KeyCode from"/node_modules/rc-util/es/KeyCode.js";import{getOffsetLeft}from"/node_modules/rc-rate/es/util.js";import Star from"/node_modules/rc-rate/es/Star.js";function noop(){}var Rate=function(_React$Component){function Rate(props){var _this;_classCallCheck(this,Rate),_this=_super.call(this,props),_this.onHover=function(event,index){var onHoverChange=_this.props.onHoverChange,hoverValue=_this.getStarValue(index,event.pageX),cleanedValue=_this.state.cleanedValue;hoverValue!==cleanedValue&&_this.setState({hoverValue:hoverValue,cleanedValue:null}),onHoverChange(hoverValue)},_this.onMouseLeave=function(){var onHoverChange=_this.props.onHoverChange;_this.setState({hoverValue:void 0,cleanedValue:null}),onHoverChange(void 0)},_this.onClick=function(event,index){var allowClear=_this.props.allowClear,value=_this.state.value,newValue=_this.getStarValue(index,event.pageX),isReset=!1;allowClear&&(isReset=newValue===value),_this.onMouseLeave(),_this.changeValue(isReset?0:newValue),_this.setState({cleanedValue:isReset?newValue:null})},_this.onFocus=function(){var onFocus=_this.props.onFocus;_this.setState({focused:!0}),onFocus&&onFocus()},_this.onBlur=function(){var onBlur=_this.props.onBlur;_this.setState({focused:!1}),onBlur&&onBlur()},_this.onKeyDown=function(event){var keyCode=event.keyCode,_this$props=_this.props,count=_this$props.count,allowHalf=_this$props.allowHalf,onKeyDown=_this$props.onKeyDown,direction=_this$props.direction,reverse="rtl"===direction,value=_this.state.value;keyCode===KeyCode.RIGHT&&value<count&&!reverse?(value+=allowHalf?.5:1,_this.changeValue(value),event.preventDefault()):keyCode===KeyCode.LEFT&&0<value&&!reverse?(value-=allowHalf?.5:1,_this.changeValue(value),event.preventDefault()):keyCode===KeyCode.RIGHT&&0<value&&reverse?(value-=allowHalf?.5:1,_this.changeValue(value),event.preventDefault()):keyCode===KeyCode.LEFT&&value<count&&reverse&&(value+=allowHalf?.5:1,_this.changeValue(value),event.preventDefault()),onKeyDown&&onKeyDown(event)},_this.saveRef=function(index){return function(node){_this.stars[index]=node}},_this.saveRate=function(node){_this.rate=node};var value=props.value;return void 0===value&&(value=props.defaultValue),_this.stars={},_this.state={value:value,focused:!1,cleanedValue:null},_this}_inherits(Rate,_React$Component);var _super=_createSuper(Rate);return _createClass(Rate,[{key:"componentDidMount",value:function componentDidMount(){var _this$props2=this.props,autoFocus=_this$props2.autoFocus,disabled=_this$props2.disabled;autoFocus&&!disabled&&this.focus()}},{key:"getStarDOM",value:function getStarDOM(index){return findDOMNode(this.stars[index])}},{key:"getStarValue",value:function getStarValue(index,x){var _this$props3=this.props,allowHalf=_this$props3.allowHalf,direction=_this$props3.direction,reverse="rtl"===direction,value=index+1;if(allowHalf){var starEle=this.getStarDOM(index),leftDis=getOffsetLeft(starEle),width=starEle.clientWidth;reverse&&x-leftDis>width/2?value-=.5:!reverse&&x-leftDis<width/2&&(value-=.5)}return value}},{key:"focus",value:function focus(){var disabled=this.props.disabled;disabled||this.rate.focus()}},{key:"blur",value:function blur(){var disabled=this.props.disabled;disabled||this.rate.blur()}},{key:"changeValue",value:function changeValue(value){var onChange=this.props.onChange;"value"in this.props||this.setState({value:value}),onChange(value)}},{key:"render",value:function render(){for(var _this$props4=this.props,count=_this$props4.count,allowHalf=_this$props4.allowHalf,style=_this$props4.style,prefixCls=_this$props4.prefixCls,disabled=_this$props4.disabled,className=_this$props4.className,character=_this$props4.character,characterRender=_this$props4.characterRender,tabIndex=_this$props4.tabIndex,direction=_this$props4.direction,_this$state=this.state,value=_this$state.value,hoverValue=_this$state.hoverValue,focused=_this$state.focused,stars=[],disabledClass=disabled?"".concat(prefixCls,"-disabled"):"",index=0;index<count;index+=1)stars.push(React.createElement(Star,{ref:this.saveRef(index),index:index,count:count,disabled:disabled,prefixCls:"".concat(prefixCls,"-star"),allowHalf:allowHalf,value:void 0===hoverValue?value:hoverValue,onClick:this.onClick,onHover:this.onHover,key:index,character:character,characterRender:characterRender,focused:focused}));var rateClassName=classNames(prefixCls,disabledClass,className,_defineProperty({},"".concat(prefixCls,"-rtl"),"rtl"===direction));return React.createElement("ul",{className:rateClassName,style:style,onMouseLeave:disabled?null:this.onMouseLeave,tabIndex:disabled?-1:tabIndex,onFocus:disabled?null:this.onFocus,onBlur:disabled?null:this.onBlur,onKeyDown:disabled?null:this.onKeyDown,ref:this.saveRate,role:"radiogroup"},stars)}}],[{key:"getDerivedStateFromProps",value:function getDerivedStateFromProps(nextProps,state){return"value"in nextProps&&void 0!==nextProps.value?_objectSpread(_objectSpread({},state),{},{value:nextProps.value}):state}}]),Rate}(React.Component);Rate.defaultProps={defaultValue:0,count:5,allowHalf:!1,allowClear:!0,style:{},prefixCls:"rc-rate",onChange:noop,character:"\u2605",onHoverChange:noop,tabIndex:0,direction:"ltr"};export default Rate;