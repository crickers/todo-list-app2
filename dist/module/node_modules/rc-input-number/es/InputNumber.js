import"/node_modules/core-js/modules/es.array.index-of.js";import"/node_modules/core-js/modules/es.array.last-index-of.js";import"/node_modules/core-js/modules/es.array.slice.js";import"/node_modules/core-js/modules/es.number.to-fixed.js";import"/node_modules/core-js/modules/es.regexp.to-string.js";import"/node_modules/core-js/modules/es.string.replace.js";import"/node_modules/core-js/modules/es.string.trim.js";import _extends from"/node_modules/@babel/runtime/helpers/esm/extends.js";import _defineProperty from"/node_modules/@babel/runtime/helpers/esm/defineProperty.js";import _objectWithoutProperties from"/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js";import _objectSpread from"/node_modules/@babel/runtime/helpers/esm/objectSpread2.js";import _classCallCheck from"/node_modules/@babel/runtime/helpers/esm/classCallCheck.js";import _createClass from"/node_modules/@babel/runtime/helpers/esm/createClass.js";import _inherits from"/node_modules/@babel/runtime/helpers/esm/inherits.js";import _createSuper from"/node_modules/@babel/runtime/helpers/esm/createSuper.js";import React from"c:\\node_modules\\react\\index.js";import classNames from"/node_modules/classnames.js";import KeyCode from"/node_modules/rc-util/es/KeyCode.js";function noop(){}function preventDefault(e){e.preventDefault()}var defaultParser=function defaultParser(input){return input.replace(/[^\w.-]+/g,"")},SPEED=200,DELAY=600,MAX_SAFE_INTEGER=Number.MAX_SAFE_INTEGER||Math.pow(2,53)-1,isValidProps=function isValidProps(value){return value!==void 0&&null!==value},isEqual=function isEqual(oldValue,newValue){return newValue===oldValue||"number"==typeof newValue&&"number"==typeof oldValue&&isNaN(newValue)&&isNaN(oldValue)},InputNumber=function(_React$Component){function InputNumber(props){var _this;_classCallCheck(this,InputNumber),_this=_super.call(this,props),_this.onKeyDown=function(e){var _this$props=_this.props,onKeyDown=_this$props.onKeyDown,onPressEnter=_this$props.onPressEnter;if(e.keyCode===KeyCode.UP){var ratio=_this.getRatio(e);_this.up(e,ratio,null),_this.stop()}else if(e.keyCode===KeyCode.DOWN){var _ratio=_this.getRatio(e);_this.down(e,_ratio,null),_this.stop()}else e.keyCode===KeyCode.ENTER&&onPressEnter&&onPressEnter(e);if(_this.recordCursorPosition(),_this.lastKeyCode=e.keyCode,onKeyDown){for(var _len=arguments.length,args=Array(1<_len?_len-1:0),_key=1;_key<_len;_key++)args[_key-1]=arguments[_key];onKeyDown.apply(void 0,[e].concat(args))}},_this.onKeyUp=function(e){var onKeyUp=_this.props.onKeyUp;if(_this.stop(),_this.recordCursorPosition(),onKeyUp){for(var _len2=arguments.length,args=Array(1<_len2?_len2-1:0),_key2=1;_key2<_len2;_key2++)args[_key2-1]=arguments[_key2];onKeyUp.apply(void 0,[e].concat(args))}},_this.onChange=function(e){var onChange=_this.props.onChange;_this.state.focused&&(_this.inputting=!0),_this.rawInput=_this.props.parser(_this.getValueFromEvent(e)),_this.setState({inputValue:_this.rawInput}),onChange(_this.toNumber(_this.rawInput))},_this.onMouseUp=function(){var onMouseUp=_this.props.onMouseUp;_this.recordCursorPosition(),onMouseUp&&onMouseUp.apply(void 0,arguments)},_this.onFocus=function(){var _this$props2;_this.setState({focused:!0}),(_this$props2=_this.props).onFocus.apply(_this$props2,arguments)},_this.onBlur=function(){var onBlur=_this.props.onBlur;_this.inputting=!1,_this.setState({focused:!1});var value=_this.getCurrentValidValue(_this.state.inputValue),newValue=_this.setValue(value,noop);if(onBlur){var originValue=_this.input.value,displayValue=_this.getInputDisplayValue({focus:!1,value:newValue});_this.input.value=displayValue,onBlur.apply(void 0,arguments),_this.input.value=originValue}},_this.getRatio=function(e){var ratio=1;return e.metaKey||e.ctrlKey?ratio=.1:e.shiftKey&&(ratio=10),ratio},_this.getFullNum=function(num){return isNaN(num)?num:/e/i.test(num+"")?(+num).toFixed(18).replace(/\.?0+$/,""):num},_this.getPrecision=function(value){if(isValidProps(_this.props.precision))return _this.props.precision;var valueString=value+"";if(0<=valueString.indexOf("e-"))return parseInt(valueString.slice(valueString.indexOf("e-")+2),10);var precision=0;return 0<=valueString.indexOf(".")&&(precision=valueString.length-valueString.indexOf(".")-1),precision},_this.getInputDisplayValue=function(state){var inputDisplayValue,_ref=state||_this.state,focused=_ref.focused,inputValue=_ref.inputValue,value=_ref.value;inputDisplayValue=focused?inputValue:_this.toPrecisionAsStep(value),(void 0===inputDisplayValue||null===inputDisplayValue)&&(inputDisplayValue="");var inputDisplayValueFormat=_this.formatWrapper(inputDisplayValue);return isValidProps(_this.props.decimalSeparator)&&(inputDisplayValueFormat=inputDisplayValueFormat.toString().replace(".",_this.props.decimalSeparator)),inputDisplayValueFormat},_this.recordCursorPosition=function(){try{_this.cursorStart=_this.input.selectionStart,_this.cursorEnd=_this.input.selectionEnd,_this.currentValue=_this.input.value,_this.cursorBefore=_this.input.value.substring(0,_this.cursorStart),_this.cursorAfter=_this.input.value.substring(_this.cursorEnd)}catch(e){}},_this.restoreByAfter=function(str){if(void 0===str)return!1;var fullStr=_this.input.value,index=fullStr.lastIndexOf(str);if(-1===index)return!1;var prevCursorPos=_this.cursorBefore.length;return _this.lastKeyCode===KeyCode.DELETE&&_this.cursorBefore.charAt(prevCursorPos-1)===str[0]?(_this.fixCaret(prevCursorPos,prevCursorPos),!0):index+str.length===fullStr.length&&(_this.fixCaret(index,index),!0)},_this.partRestoreByAfter=function(str){return void 0!==str&&Array.prototype.some.call(str,function(_,start){var partStr=str.substring(start);return _this.restoreByAfter(partStr)})},_this.isNotCompleteNumber=function(num){return isNaN(num)||""===num||null===num||num&&num.toString().indexOf(".")===num.toString().length-1},_this.stop=function(){_this.autoStepTimer&&clearTimeout(_this.autoStepTimer)},_this.down=function(e,ratio,recursive){_this.pressingUpOrDown=!0,_this.step("down",e,ratio,recursive)},_this.up=function(e,ratio,recursive){_this.pressingUpOrDown=!0,_this.step("up",e,ratio,recursive)},_this.saveInput=function(node){_this.input=node};var value=props.value;void 0===value&&(value=props.defaultValue),_this.state={focused:props.autoFocus};var validValue=_this.getValidValue(_this.toNumber(value));return _this.state=_objectSpread(_objectSpread({},_this.state),{},{inputValue:_this.toPrecisionAsStep(validValue),value:validValue}),_this}_inherits(InputNumber,_React$Component);var _super=_createSuper(InputNumber);return _createClass(InputNumber,[{key:"componentDidMount",value:function componentDidMount(){this.componentDidUpdate(null)}},{key:"componentDidUpdate",value:function componentDidUpdate(prevProps){var _this$props3=this.props,value=_this$props3.value,onChange=_this$props3.onChange,max=_this$props3.max,min=_this$props3.min,focused=this.state.focused;if(prevProps){if(!isEqual(prevProps.value,value)||!isEqual(prevProps.max,max)||!isEqual(prevProps.min,min)){var nextInputValue,validValue=focused?value:this.getValidValue(value);nextInputValue=this.pressingUpOrDown?validValue:this.inputting?this.rawInput:this.toPrecisionAsStep(validValue),this.setState({value:validValue,inputValue:nextInputValue})}var nextValue="value"in this.props?value:this.state.value;"max"in this.props&&prevProps.max!==max&&"number"==typeof nextValue&&nextValue>max&&onChange&&onChange(max),"min"in this.props&&prevProps.min!==min&&"number"==typeof nextValue&&nextValue<min&&onChange&&onChange(min)}try{if(void 0!==this.cursorStart&&this.state.focused)if(!this.partRestoreByAfter(this.cursorAfter)&&this.state.value!==this.props.value){var pos=this.getInputDisplayValue(this.state).length;this.cursorAfter?this.lastKeyCode===KeyCode.BACKSPACE?pos=this.cursorStart-1:this.lastKeyCode===KeyCode.DELETE&&(pos=this.cursorStart):pos=this.input.value.length,this.fixCaret(pos,pos)}else if(this.currentValue===this.input.value)switch(this.lastKeyCode){case KeyCode.BACKSPACE:this.fixCaret(this.cursorStart-1,this.cursorStart-1);break;case KeyCode.DELETE:this.fixCaret(this.cursorStart+1,this.cursorStart+1);break;default:}}catch(e){}this.lastKeyCode=null,!this.pressingUpOrDown||this.props.focusOnUpDown&&this.state.focused&&document.activeElement!==this.input&&this.focus()}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.stop()}},{key:"getCurrentValidValue",value:function getCurrentValidValue(value){var val=value;return val=""===val?"":this.isNotCompleteNumber(parseFloat(val))?this.state.value:this.getValidValue(val),this.toNumber(val)}},{key:"getValueFromEvent",value:function getValueFromEvent(e){var value=e.target.value.trim().replace(/ã€‚/g,".");return isValidProps(this.props.decimalSeparator)&&(value=value.replace(this.props.decimalSeparator,".")),value}},{key:"getValidValue",value:function getValidValue(value){var _this$props4=this.props,min=_this$props4.min,max=_this$props4.max,val=parseFloat(value);return isNaN(val)?value:(val<min&&(val=min),val>max&&(val=max),val)}},{key:"setValue",value:function setValue(v,callback){var precision=this.props.precision,newValue=this.isNotCompleteNumber(parseFloat(v))?null:parseFloat(v),_this$state$value=this.state.value,value=void 0===_this$state$value?null:_this$state$value,_this$state$inputValu=this.state.inputValue,inputValue=void 0===_this$state$inputValu?null:_this$state$inputValu,newValueInString="number"==typeof newValue?newValue.toFixed(precision):"".concat(newValue),changed=newValue!==value||newValueInString!=="".concat(inputValue);return"value"in this.props?(inputValue=this.toPrecisionAsStep(this.state.value),this.setState({inputValue:inputValue},callback)):this.setState({value:newValue,inputValue:this.toPrecisionAsStep(v)},callback),changed&&this.props.onChange(newValue),newValue}},{key:"getMaxPrecision",value:function getMaxPrecision(currentValue){var ratio=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,_this$props5=this.props,precision=_this$props5.precision,step=_this$props5.step;if(isValidProps(precision))return precision;var ratioPrecision=this.getPrecision(ratio),stepPrecision=this.getPrecision(step),currentValuePrecision=this.getPrecision(currentValue);return currentValue?Math.max(currentValuePrecision,ratioPrecision+stepPrecision):ratioPrecision+stepPrecision}},{key:"getPrecisionFactor",value:function getPrecisionFactor(currentValue){var ratio=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,precision=this.getMaxPrecision(currentValue,ratio);return Math.pow(10,precision)}},{key:"focus",value:function focus(){this.input.focus(),this.recordCursorPosition()}},{key:"blur",value:function blur(){this.input.blur()}},{key:"select",value:function select(){this.input.select()}},{key:"formatWrapper",value:function formatWrapper(num){return this.props.formatter?this.props.formatter(num):num}},{key:"toPrecisionAsStep",value:function toPrecisionAsStep(num){if(this.isNotCompleteNumber(num)||""===num)return num;var precision=Math.abs(this.getMaxPrecision(num));return isNaN(precision)?num.toString():(+num).toFixed(precision)}},{key:"toNumber",value:function toNumber(num){var precision=this.props.precision,focused=this.state.focused,numberIsTooLarge=num&&16<num.length&&focused;return this.isNotCompleteNumber(num)||numberIsTooLarge?num:isValidProps(precision)?Math.round(num*Math.pow(10,precision))/Math.pow(10,precision):+num}},{key:"upStep",value:function upStep(val,rat){var step=this.props.step,precisionFactor=this.getPrecisionFactor(val,rat),precision=Math.abs(this.getMaxPrecision(val,rat)),result=((precisionFactor*val+precisionFactor*+step*rat)/precisionFactor).toFixed(precision);return this.toNumber(result)}},{key:"downStep",value:function downStep(val,rat){var step=this.props.step,precisionFactor=this.getPrecisionFactor(val,rat),precision=Math.abs(this.getMaxPrecision(val,rat)),result=((precisionFactor*val-precisionFactor*+step*rat)/precisionFactor).toFixed(precision);return this.toNumber(result)}},{key:"step",value:function step(type,e){var _this2=this,ratio=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,recursive=3<arguments.length?arguments[3]:void 0;this.stop(),this.recordCursorPosition(),e&&(e.persist(),e.preventDefault());var props=this.props;if(!props.disabled){var value=this.getCurrentValidValue(this.state.inputValue)||0;if(!this.isNotCompleteNumber(value)){var val=this["".concat(type,"Step")](value,ratio),outOfRange=val>props.max||val<props.min;val>props.max?val=props.max:val<props.min&&(val=props.min),this.setValue(val,null),props.onStep&&props.onStep(val,{offset:ratio,type:type}),this.setState({focused:!0},function(){_this2.pressingUpOrDown=!1}),outOfRange||(this.autoStepTimer=setTimeout(function(){_this2[type](e,ratio,!0)},recursive?SPEED:DELAY))}}}},{key:"fixCaret",value:function fixCaret(start,end){if(void 0!==start&&void 0!==end&&this.input&&this.input.value)try{var currentStart=this.input.selectionStart,currentEnd=this.input.selectionEnd;(start!==currentStart||end!==currentEnd)&&this.input.setSelectionRange(start,end)}catch(e){}}},{key:"render",value:function render(){var _classNames,_this$props6=this.props,prefixCls=_this$props6.prefixCls,disabled=_this$props6.disabled,readOnly=_this$props6.readOnly,useTouch=_this$props6.useTouch,autoComplete=_this$props6.autoComplete,upHandler=_this$props6.upHandler,downHandler=_this$props6.downHandler,className=_this$props6.className,max=_this$props6.max,min=_this$props6.min,style=_this$props6.style,title=_this$props6.title,onMouseEnter=_this$props6.onMouseEnter,onMouseLeave=_this$props6.onMouseLeave,onMouseOver=_this$props6.onMouseOver,onMouseOut=_this$props6.onMouseOut,required=_this$props6.required,onClick=_this$props6.onClick,tabIndex=_this$props6.tabIndex,type=_this$props6.type,placeholder=_this$props6.placeholder,id=_this$props6.id,inputMode=_this$props6.inputMode,pattern=_this$props6.pattern,step=_this$props6.step,maxLength=_this$props6.maxLength,autoFocus=_this$props6.autoFocus,name=_this$props6.name,onPaste=_this$props6.onPaste,onInput=_this$props6.onInput,rest=_objectWithoutProperties(_this$props6,["prefixCls","disabled","readOnly","useTouch","autoComplete","upHandler","downHandler","className","max","min","style","title","onMouseEnter","onMouseLeave","onMouseOver","onMouseOut","required","onClick","tabIndex","type","placeholder","id","inputMode","pattern","step","maxLength","autoFocus","name","onPaste","onInput"]),_this$state=this.state,value=_this$state.value,focused=_this$state.focused,classes=classNames(prefixCls,(_classNames={},_defineProperty(_classNames,className,!!className),_defineProperty(_classNames,"".concat(prefixCls,"-disabled"),disabled),_defineProperty(_classNames,"".concat(prefixCls,"-focused"),focused),_classNames)),dataOrAriaAttributeProps={};Object.keys(rest).forEach(function(key){("data-"===key.substr(0,5)||"aria-"===key.substr(0,5)||"role"===key)&&(dataOrAriaAttributeProps[key]=rest[key])});var editable=!readOnly&&!disabled,inputDisplayValue=this.getInputDisplayValue(null),upDisabled=(value||0===value)&&(isNaN(value)||+value>=max),downDisabled=(value||0===value)&&(isNaN(value)||+value<=min),isUpDisabled=upDisabled||disabled||readOnly,isDownDisabled=downDisabled||disabled||readOnly,upClassName=classNames("".concat(prefixCls,"-handler"),"".concat(prefixCls,"-handler-up"),_defineProperty({},"".concat(prefixCls,"-handler-up-disabled"),isUpDisabled)),downClassName=classNames("".concat(prefixCls,"-handler"),"".concat(prefixCls,"-handler-down"),_defineProperty({},"".concat(prefixCls,"-handler-down-disabled"),isDownDisabled)),upEvents=useTouch?{onTouchStart:isUpDisabled?noop:this.up,onTouchEnd:this.stop}:{onMouseDown:isUpDisabled?noop:this.up,onMouseUp:this.stop,onMouseLeave:this.stop},downEvents=useTouch?{onTouchStart:isDownDisabled?noop:this.down,onTouchEnd:this.stop}:{onMouseDown:isDownDisabled?noop:this.down,onMouseUp:this.stop,onMouseLeave:this.stop};return React.createElement("div",{className:classes,style:style,title:title,onMouseEnter:onMouseEnter,onMouseLeave:onMouseLeave,onMouseOver:onMouseOver,onMouseOut:onMouseOut,onFocus:function onFocus(){return null},onBlur:function onBlur(){return null}},React.createElement("div",{className:"".concat(prefixCls,"-handler-wrap")},React.createElement("span",_extends({unselectable:"on"},upEvents,{role:"button","aria-label":"Increase Value","aria-disabled":isUpDisabled,className:upClassName}),upHandler||React.createElement("span",{unselectable:"on",className:"".concat(prefixCls,"-handler-up-inner"),onClick:preventDefault})),React.createElement("span",_extends({unselectable:"on"},downEvents,{role:"button","aria-label":"Decrease Value","aria-disabled":isDownDisabled,className:downClassName}),downHandler||React.createElement("span",{unselectable:"on",className:"".concat(prefixCls,"-handler-down-inner"),onClick:preventDefault}))),React.createElement("div",{className:"".concat(prefixCls,"-input-wrap")},React.createElement("input",_extends({role:"spinbutton","aria-valuemin":min,"aria-valuemax":max,"aria-valuenow":value,required:required,type:type,placeholder:placeholder,onPaste:onPaste,onClick:onClick,onMouseUp:this.onMouseUp,className:"".concat(prefixCls,"-input"),tabIndex:tabIndex,autoComplete:autoComplete,onFocus:this.onFocus,onBlur:this.onBlur,onKeyDown:editable?this.onKeyDown:noop,onKeyUp:editable?this.onKeyUp:noop,autoFocus:autoFocus,maxLength:maxLength,readOnly:readOnly,disabled:disabled,max:max,min:min,step:step,name:name,title:title,id:id,onChange:this.onChange,ref:this.saveInput,value:this.getFullNum(inputDisplayValue),pattern:pattern,inputMode:inputMode,onInput:onInput},dataOrAriaAttributeProps))))}}]),InputNumber}(React.Component);InputNumber.defaultProps={focusOnUpDown:!0,useTouch:!1,prefixCls:"rc-input-number",max:MAX_SAFE_INTEGER,min:-MAX_SAFE_INTEGER,step:1,style:{},onChange:noop,onKeyDown:noop,onPressEnter:noop,onFocus:noop,onBlur:noop,parser:defaultParser,required:!1,autoComplete:"off"};export default InputNumber;