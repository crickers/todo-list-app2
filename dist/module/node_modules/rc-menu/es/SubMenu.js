import"/node_modules/core-js/modules/es.array.index-of.js";import"/node_modules/core-js/modules/es.object.assign.js";import _classCallCheck from"/node_modules/@babel/runtime/helpers/esm/classCallCheck.js";import _createClass from"/node_modules/@babel/runtime/helpers/esm/createClass.js";import _assertThisInitialized from"/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js";import _inherits from"/node_modules/@babel/runtime/helpers/esm/inherits.js";import _createSuper from"/node_modules/@babel/runtime/helpers/esm/createSuper.js";import _defineProperty from"/node_modules/@babel/runtime/helpers/esm/defineProperty.js";import _objectSpread from"/node_modules/@babel/runtime/helpers/esm/objectSpread2.js";import React from"c:\\node_modules\\react\\index.js";import ReactDOM from"c:\\node_modules\\react-dom\\index.js";import Trigger from"/node_modules/rc-trigger.js";import raf from"/node_modules/rc-util/es/raf.js";import KeyCode from"/node_modules/rc-util/es/KeyCode.js";import CSSMotion from"/node_modules/rc-motion.js";import classNames from"/node_modules/classnames.js";import{connect}from"/node_modules/mini-store.js";import SubPopupMenu from"/node_modules/rc-menu/es/SubPopupMenu.js";import{placements,placementsRtl}from"/node_modules/rc-menu/es/placements.js";import{noop,loopMenuItemRecursively,getMenuIdFromSubMenuEventKey,menuAllProps}from"/node_modules/rc-menu/es/util.js";var guid=0,popupPlacementMap={horizontal:"bottomLeft",vertical:"rightTop","vertical-left":"rightTop","vertical-right":"leftTop"},updateDefaultActiveFirst=function updateDefaultActiveFirst(store,eventKey,defaultActiveFirst){var menuId=getMenuIdFromSubMenuEventKey(eventKey),state=store.getState();store.setState({defaultActiveFirst:_objectSpread(_objectSpread({},state.defaultActiveFirst),{},_defineProperty({},menuId,defaultActiveFirst))})};export var SubMenu=function(_React$Component){function SubMenu(props){var _this;_classCallCheck(this,SubMenu),_this=_super.call(this,props),_this.onDestroy=function(key){_this.props.onDestroy(key)},_this.onKeyDown=function(e){var keyCode=e.keyCode,menu=_this.menuInstance,store=_this.props.store,visible=_this.getVisible();if(keyCode===KeyCode.ENTER)return _this.onTitleClick(e),updateDefaultActiveFirst(store,_this.props.eventKey,!0),!0;if(keyCode===KeyCode.RIGHT)return visible?menu.onKeyDown(e):(_this.triggerOpenChange(!0),updateDefaultActiveFirst(store,_this.props.eventKey,!0)),!0;if(keyCode===KeyCode.LEFT){var handled;if(visible)handled=menu.onKeyDown(e);else return;return handled||(_this.triggerOpenChange(!1),handled=!0),handled}return visible&&(keyCode===KeyCode.UP||keyCode===KeyCode.DOWN)?menu.onKeyDown(e):void 0},_this.onOpenChange=function(e){_this.props.onOpenChange(e)},_this.onPopupVisibleChange=function(visible){_this.triggerOpenChange(visible,visible?"mouseenter":"mouseleave")},_this.onMouseEnter=function(e){var _this$props=_this.props,key=_this$props.eventKey,onMouseEnter=_this$props.onMouseEnter,store=_this$props.store;updateDefaultActiveFirst(store,_this.props.eventKey,!1),onMouseEnter({key:key,domEvent:e})},_this.onMouseLeave=function(e){var _this$props2=_this.props,parentMenu=_this$props2.parentMenu,eventKey=_this$props2.eventKey,onMouseLeave=_this$props2.onMouseLeave;parentMenu.subMenuInstance=_assertThisInitialized(_this),onMouseLeave({key:eventKey,domEvent:e})},_this.onTitleMouseEnter=function(domEvent){var _this$props3=_this.props,key=_this$props3.eventKey,onItemHover=_this$props3.onItemHover,onTitleMouseEnter=_this$props3.onTitleMouseEnter;onItemHover({key:key,hover:!0}),onTitleMouseEnter({key:key,domEvent:domEvent})},_this.onTitleMouseLeave=function(e){var _this$props4=_this.props,parentMenu=_this$props4.parentMenu,eventKey=_this$props4.eventKey,onItemHover=_this$props4.onItemHover,onTitleMouseLeave=_this$props4.onTitleMouseLeave;parentMenu.subMenuInstance=_assertThisInitialized(_this),onItemHover({key:eventKey,hover:!1}),onTitleMouseLeave({key:eventKey,domEvent:e})},_this.onTitleClick=function(e){var _assertThisInitialize=_assertThisInitialized(_this),props=_assertThisInitialize.props;props.onTitleClick({key:props.eventKey,domEvent:e}),"hover"===props.triggerSubMenuAction||(_this.triggerOpenChange(!_this.getVisible(),"click"),updateDefaultActiveFirst(props.store,_this.props.eventKey,!1))},_this.onSubMenuClick=function(info){"function"==typeof _this.props.onClick&&_this.props.onClick(_this.addKeyPath(info))},_this.onSelect=function(info){_this.props.onSelect(info)},_this.onDeselect=function(info){_this.props.onDeselect(info)},_this.getPrefixCls=function(){return"".concat(_this.props.rootPrefixCls,"-submenu")},_this.getActiveClassName=function(){return"".concat(_this.getPrefixCls(),"-active")},_this.getDisabledClassName=function(){return"".concat(_this.getPrefixCls(),"-disabled")},_this.getSelectedClassName=function(){return"".concat(_this.getPrefixCls(),"-selected")},_this.getOpenClassName=function(){return"".concat(_this.props.rootPrefixCls,"-submenu-open")},_this.getVisible=function(){return _this.state.isOpen},_this.getMode=function(){return _this.state.mode},_this.saveMenuInstance=function(c){_this.menuInstance=c},_this.addKeyPath=function(info){return _objectSpread(_objectSpread({},info),{},{keyPath:(info.keyPath||[]).concat(_this.props.eventKey)})},_this.triggerOpenChange=function(open,type){var key=_this.props.eventKey,openChange=function openChange(){_this.onOpenChange({key:key,item:_assertThisInitialized(_this),trigger:type,open:open})};"mouseenter"===type?_this.mouseenterTimeout=setTimeout(function(){openChange()},0):openChange()},_this.isChildrenSelected=function(){var ret={find:!1};return loopMenuItemRecursively(_this.props.children,_this.props.selectedKeys,ret),ret.find},_this.isInlineMode=function(){return"inline"===_this.getMode()},_this.adjustWidth=function(){if(_this.subMenuTitle&&_this.menuInstance){var popupMenu=ReactDOM.findDOMNode(_this.menuInstance);popupMenu.offsetWidth>=_this.subMenuTitle.offsetWidth||(popupMenu.style.minWidth="".concat(_this.subMenuTitle.offsetWidth,"px"))}},_this.saveSubMenuTitle=function(subMenuTitle){_this.subMenuTitle=subMenuTitle},_this.getBaseProps=function(){var _assertThisInitialize2=_assertThisInitialized(_this),props=_assertThisInitialize2.props,mergedMode=_this.getMode();return{mode:"horizontal"===mergedMode?"vertical":mergedMode,visible:_this.getVisible(),level:props.level+1,inlineIndent:props.inlineIndent,focusable:!1,onClick:_this.onSubMenuClick,onSelect:_this.onSelect,onDeselect:_this.onDeselect,onDestroy:_this.onDestroy,selectedKeys:props.selectedKeys,eventKey:"".concat(props.eventKey,"-menu-"),openKeys:props.openKeys,motion:props.motion,onOpenChange:_this.onOpenChange,subMenuOpenDelay:props.subMenuOpenDelay,parentMenu:_assertThisInitialized(_this),subMenuCloseDelay:props.subMenuCloseDelay,forceSubMenuRender:props.forceSubMenuRender,triggerSubMenuAction:props.triggerSubMenuAction,builtinPlacements:props.builtinPlacements,defaultActiveFirst:props.store.getState().defaultActiveFirst[getMenuIdFromSubMenuEventKey(props.eventKey)],multiple:props.multiple,prefixCls:props.rootPrefixCls,id:_this.internalMenuId,manualRef:_this.saveMenuInstance,itemIcon:props.itemIcon,expandIcon:props.expandIcon,direction:props.direction}},_this.getMotion=function(mode,visible){var _assertThisInitialize3=_assertThisInitialized(_this),haveRendered=_assertThisInitialize3.haveRendered,_this$props5=_this.props,motion=_this$props5.motion,rootPrefixCls=_this$props5.rootPrefixCls,mergedMotion=_objectSpread(_objectSpread({},motion),{},{leavedClassName:"".concat(rootPrefixCls,"-hidden"),removeOnLeave:!1,motionAppear:haveRendered||!visible||"inline"!==mode});return mergedMotion};var store=props.store,eventKey=props.eventKey,_store$getState=store.getState(),defaultActiveFirst=_store$getState.defaultActiveFirst;_this.isRootMenu=!1;var value=!1;return defaultActiveFirst&&(value=defaultActiveFirst[eventKey]),updateDefaultActiveFirst(store,eventKey,value),_this.state={mode:props.mode,isOpen:props.isOpen},_this}_inherits(SubMenu,_React$Component);var _super=_createSuper(SubMenu);return _createClass(SubMenu,[{key:"componentDidMount",value:function componentDidMount(){this.componentDidUpdate()}},{key:"componentDidUpdate",value:function componentDidUpdate(){var _this2=this,_this$props6=this.props,mode=_this$props6.mode,parentMenu=_this$props6.parentMenu,manualRef=_this$props6.manualRef,isOpen=_this$props6.isOpen,updateState=function updateState(){_this2.setState({mode:mode,isOpen:isOpen})},isOpenChanged=isOpen!==this.state.isOpen,isModeChanged=mode!==this.state.mode;(isModeChanged||isOpenChanged)&&(raf.cancel(this.updateStateRaf),isModeChanged?this.updateStateRaf=raf(updateState):updateState()),manualRef&&manualRef(this),"horizontal"===mode&&null!==parentMenu&&void 0!==parentMenu&&parentMenu.isRootMenu&&isOpen&&(this.minWidthTimeout=setTimeout(function(){return _this2.adjustWidth()},0))}},{key:"componentWillUnmount",value:function componentWillUnmount(){var _this$props7=this.props,onDestroy=_this$props7.onDestroy,eventKey=_this$props7.eventKey;onDestroy&&onDestroy(eventKey),this.minWidthTimeout&&clearTimeout(this.minWidthTimeout),this.mouseenterTimeout&&clearTimeout(this.mouseenterTimeout),raf.cancel(this.updateStateRaf)}},{key:"renderPopupMenu",value:function renderPopupMenu(className,style){var baseProps=this.getBaseProps();return React.createElement(SubPopupMenu,Object.assign({},baseProps,{id:this.internalMenuId,className:className,style:style}),this.props.children)}},{key:"renderChildren",value:function renderChildren(){var _this3=this,baseProps=this.getBaseProps(),mode=baseProps.mode,visible=baseProps.visible,forceSubMenuRender=baseProps.forceSubMenuRender,direction=baseProps.direction,mergedMotion=this.getMotion(mode,visible);if(this.haveRendered=!0,this.haveOpened=this.haveOpened||visible||forceSubMenuRender,!this.haveOpened)return React.createElement("div",null);var sharedClassName=classNames("".concat(baseProps.prefixCls,"-sub"),_defineProperty({},"".concat(baseProps.prefixCls,"-rtl"),"rtl"===direction));return this.isInlineMode()?React.createElement(CSSMotion,Object.assign({visible:baseProps.visible},mergedMotion),function(_ref){var className=_ref.className,style=_ref.style,mergedClassName=classNames(sharedClassName,className);return _this3.renderPopupMenu(mergedClassName,style)}):this.renderPopupMenu(sharedClassName)}},{key:"render",value:function render(){var _classNames2,_props$parentMenu,_classNames3,props=_objectSpread({},this.props),visible=this.getVisible(),prefixCls=this.getPrefixCls(),inline=this.isInlineMode(),mergedMode=this.getMode(),className=classNames(prefixCls,"".concat(prefixCls,"-").concat(mergedMode),(_classNames2={},_defineProperty(_classNames2,props.className,!!props.className),_defineProperty(_classNames2,this.getOpenClassName(),visible),_defineProperty(_classNames2,this.getActiveClassName(),props.active||visible&&!inline),_defineProperty(_classNames2,this.getDisabledClassName(),props.disabled),_defineProperty(_classNames2,this.getSelectedClassName(),this.isChildrenSelected()),_classNames2));this.internalMenuId||(props.eventKey?this.internalMenuId="".concat(props.eventKey,"$Menu"):(guid+=1,this.internalMenuId="$__$".concat(guid,"$Menu")));var mouseEvents={},titleClickEvents={},titleMouseEvents={};props.disabled||(mouseEvents={onMouseLeave:this.onMouseLeave,onMouseEnter:this.onMouseEnter},titleClickEvents={onClick:this.onTitleClick},titleMouseEvents={onMouseEnter:this.onTitleMouseEnter,onMouseLeave:this.onTitleMouseLeave});var style={},direction=props.direction,isRTL="rtl"===direction;inline&&(isRTL?style.paddingRight=props.inlineIndent*props.level:style.paddingLeft=props.inlineIndent*props.level);var ariaOwns={};this.getVisible()&&(ariaOwns={"aria-owns":this.internalMenuId});var icon=null;"horizontal"!==mergedMode&&(icon=this.props.expandIcon,"function"==typeof this.props.expandIcon&&(icon=React.createElement(this.props.expandIcon,_objectSpread({},this.props))));var title=React.createElement("div",Object.assign({ref:this.saveSubMenuTitle,style:style,className:"".concat(prefixCls,"-title"),role:"button"},titleMouseEvents,titleClickEvents,{"aria-expanded":visible},ariaOwns,{"aria-haspopup":"true",title:"string"==typeof props.title?props.title:void 0}),props.title,icon||React.createElement("i",{className:"".concat(prefixCls,"-arrow")})),children=this.renderChildren(),getPopupContainer=(null===(_props$parentMenu=props.parentMenu)||void 0===_props$parentMenu?void 0:_props$parentMenu.isRootMenu)?props.parentMenu.props.getPopupContainer:function(triggerNode){return triggerNode.parentNode},popupPlacement=popupPlacementMap[mergedMode],popupAlign=props.popupOffset?{offset:props.popupOffset}:{},popupClassName=classNames((_classNames3={},_defineProperty(_classNames3,props.popupClassName,props.popupClassName&&!inline),_defineProperty(_classNames3,"".concat(prefixCls,"-rtl"),isRTL),_classNames3)),disabled=props.disabled,triggerSubMenuAction=props.triggerSubMenuAction,subMenuOpenDelay=props.subMenuOpenDelay,forceSubMenuRender=props.forceSubMenuRender,subMenuCloseDelay=props.subMenuCloseDelay,builtinPlacements=props.builtinPlacements;menuAllProps.forEach(function(key){return delete props[key]}),delete props.onClick;var placement=isRTL?Object.assign({},placementsRtl,builtinPlacements):Object.assign({},placements,builtinPlacements);delete props.direction;var baseProps=this.getBaseProps(),mergedMotion=inline?null:this.getMotion(baseProps.mode,baseProps.visible);return React.createElement("li",Object.assign({},props,mouseEvents,{className:className,role:"menuitem"}),React.createElement(Trigger,{prefixCls:prefixCls,popupClassName:classNames("".concat(prefixCls,"-popup"),popupClassName),getPopupContainer:getPopupContainer,builtinPlacements:placement,popupPlacement:popupPlacement,popupVisible:!inline&&visible,popupAlign:popupAlign,popup:inline?null:children,action:disabled||inline?[]:[triggerSubMenuAction],mouseEnterDelay:subMenuOpenDelay,mouseLeaveDelay:subMenuCloseDelay,onPopupVisibleChange:this.onPopupVisibleChange,forceRender:forceSubMenuRender,popupMotion:mergedMotion},title),inline?children:null)}}]),SubMenu}(React.Component);SubMenu.defaultProps={onMouseEnter:noop,onMouseLeave:noop,onTitleMouseEnter:noop,onTitleMouseLeave:noop,onTitleClick:noop,manualRef:noop,mode:"vertical",title:""};var connected=connect(function(_ref2,_ref3){var openKeys=_ref2.openKeys,activeKey=_ref2.activeKey,selectedKeys=_ref2.selectedKeys,eventKey=_ref3.eventKey,subMenuKey=_ref3.subMenuKey;return{isOpen:-1<openKeys.indexOf(eventKey),active:activeKey[subMenuKey]===eventKey,selectedKeys:selectedKeys}})(SubMenu);connected.isSubMenu=!0;export default connected;