import _extends from"/node_modules/@babel/runtime/helpers/esm/extends.js";import _defineProperty from"/node_modules/@babel/runtime/helpers/esm/defineProperty.js";import _objectWithoutProperties from"/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js";import _objectSpread from"/node_modules/@babel/runtime/helpers/esm/objectSpread2.js";import _classCallCheck from"/node_modules/@babel/runtime/helpers/esm/classCallCheck.js";import _createClass from"/node_modules/@babel/runtime/helpers/esm/createClass.js";import _assertThisInitialized from"/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js";import _inherits from"/node_modules/@babel/runtime/helpers/esm/inherits.js";import _createSuper from"/node_modules/@babel/runtime/helpers/esm/createSuper.js";import React from"c:\\node_modules\\react\\index.js";import classNames from"/node_modules/classnames.js";import{TreeContext}from"/node_modules/rc-tree/es/contextTypes.js";import{getDataAndAria}from"/node_modules/rc-tree/es/util.js";import Indent from"/node_modules/rc-tree/es/Indent.js";import{convertNodePropsToEventData}from"/node_modules/rc-tree/es/utils/treeUtil.js";var ICON_OPEN="open",ICON_CLOSE="close",defaultTitle="---",InternalTreeNode=function(_React$Component){function InternalTreeNode(){var _this;return _classCallCheck(this,InternalTreeNode),_this=_super.apply(this,arguments),_this.state={dragNodeHighlight:!1},_this.onSelectorClick=function(e){var onNodeClick=_this.props.context.onNodeClick;onNodeClick(e,convertNodePropsToEventData(_this.props)),_this.isSelectable()?_this.onSelect(e):_this.onCheck(e)},_this.onSelectorDoubleClick=function(e){var onNodeDoubleClick=_this.props.context.onNodeDoubleClick;onNodeDoubleClick(e,convertNodePropsToEventData(_this.props))},_this.onSelect=function(e){if(!_this.isDisabled()){var onNodeSelect=_this.props.context.onNodeSelect;e.preventDefault(),onNodeSelect(e,convertNodePropsToEventData(_this.props))}},_this.onCheck=function(e){if(!_this.isDisabled()){var _this$props=_this.props,disableCheckbox=_this$props.disableCheckbox,checked=_this$props.checked,onNodeCheck=_this.props.context.onNodeCheck;!_this.isCheckable()||disableCheckbox||(e.preventDefault(),onNodeCheck(e,convertNodePropsToEventData(_this.props),!checked))}},_this.onMouseEnter=function(e){var onNodeMouseEnter=_this.props.context.onNodeMouseEnter;onNodeMouseEnter(e,convertNodePropsToEventData(_this.props))},_this.onMouseLeave=function(e){var onNodeMouseLeave=_this.props.context.onNodeMouseLeave;onNodeMouseLeave(e,convertNodePropsToEventData(_this.props))},_this.onContextMenu=function(e){var onNodeContextMenu=_this.props.context.onNodeContextMenu;onNodeContextMenu(e,convertNodePropsToEventData(_this.props))},_this.onDragStart=function(e){var onNodeDragStart=_this.props.context.onNodeDragStart;e.stopPropagation(),_this.setState({dragNodeHighlight:!0}),onNodeDragStart(e,_assertThisInitialized(_this));try{e.dataTransfer.setData("text/plain","")}catch(error){}},_this.onDragEnter=function(e){var onNodeDragEnter=_this.props.context.onNodeDragEnter;e.preventDefault(),e.stopPropagation(),onNodeDragEnter(e,_assertThisInitialized(_this))},_this.onDragOver=function(e){var onNodeDragOver=_this.props.context.onNodeDragOver;e.preventDefault(),e.stopPropagation(),onNodeDragOver(e,_assertThisInitialized(_this))},_this.onDragLeave=function(e){var onNodeDragLeave=_this.props.context.onNodeDragLeave;e.stopPropagation(),onNodeDragLeave(e,_assertThisInitialized(_this))},_this.onDragEnd=function(e){var onNodeDragEnd=_this.props.context.onNodeDragEnd;e.stopPropagation(),_this.setState({dragNodeHighlight:!1}),onNodeDragEnd(e,_assertThisInitialized(_this))},_this.onDrop=function(e){var onNodeDrop=_this.props.context.onNodeDrop;e.preventDefault(),e.stopPropagation(),_this.setState({dragNodeHighlight:!1}),onNodeDrop(e,_assertThisInitialized(_this))},_this.onExpand=function(e){var _this$props2=_this.props,loading=_this$props2.loading,onNodeExpand=_this$props2.context.onNodeExpand;loading||onNodeExpand(e,convertNodePropsToEventData(_this.props))},_this.setSelectHandle=function(node){_this.selectHandle=node},_this.getNodeState=function(){var expanded=_this.props.expanded;return _this.isLeaf()?null:expanded?ICON_OPEN:ICON_CLOSE},_this.hasChildren=function(){var eventKey=_this.props.eventKey,keyEntities=_this.props.context.keyEntities,_ref=keyEntities[eventKey]||{},children=_ref.children;return!!(children||[]).length},_this.isLeaf=function(){var _this$props3=_this.props,isLeaf=_this$props3.isLeaf,loaded=_this$props3.loaded,loadData=_this.props.context.loadData,hasChildren=_this.hasChildren();return!1!==isLeaf&&(isLeaf||!loadData&&!hasChildren||loadData&&loaded&&!hasChildren)},_this.isDisabled=function(){var disabled=_this.props.disabled,treeDisabled=_this.props.context.disabled;return!!(treeDisabled||disabled)},_this.isCheckable=function(){var checkable=_this.props.checkable,treeCheckable=_this.props.context.checkable;return!!(treeCheckable&&!1!==checkable)&&treeCheckable},_this.syncLoadData=function(props){var expanded=props.expanded,loading=props.loading,loaded=props.loaded,_this$props$context=_this.props.context,loadData=_this$props$context.loadData,onNodeLoad=_this$props$context.onNodeLoad;loading||loadData&&expanded&&!_this.isLeaf()&&!_this.hasChildren()&&!loaded&&onNodeLoad(convertNodePropsToEventData(_this.props))},_this.renderSwitcher=function(){var _this$props4=_this.props,expanded=_this$props4.expanded,switcherIconFromProps=_this$props4.switcherIcon,_this$props$context2=_this.props.context,prefixCls=_this$props$context2.prefixCls,switcherIconFromCtx=_this$props$context2.switcherIcon,switcherIcon=switcherIconFromProps||switcherIconFromCtx;if(_this.isLeaf())return React.createElement("span",{className:classNames("".concat(prefixCls,"-switcher"),"".concat(prefixCls,"-switcher-noop"))},"function"==typeof switcherIcon?switcherIcon(_objectSpread(_objectSpread({},_this.props),{},{isLeaf:!0})):switcherIcon);var switcherCls=classNames("".concat(prefixCls,"-switcher"),"".concat(prefixCls,"-switcher_").concat(expanded?ICON_OPEN:ICON_CLOSE));return React.createElement("span",{onClick:_this.onExpand,className:switcherCls},"function"==typeof switcherIcon?switcherIcon(_objectSpread(_objectSpread({},_this.props),{},{isLeaf:!1})):switcherIcon)},_this.renderCheckbox=function(){var _this$props5=_this.props,checked=_this$props5.checked,halfChecked=_this$props5.halfChecked,disableCheckbox=_this$props5.disableCheckbox,prefixCls=_this.props.context.prefixCls,disabled=_this.isDisabled(),checkable=_this.isCheckable();if(!checkable)return null;var $custom="boolean"==typeof checkable?null:checkable;return React.createElement("span",{className:classNames("".concat(prefixCls,"-checkbox"),checked&&"".concat(prefixCls,"-checkbox-checked"),!checked&&halfChecked&&"".concat(prefixCls,"-checkbox-indeterminate"),(disabled||disableCheckbox)&&"".concat(prefixCls,"-checkbox-disabled")),onClick:_this.onCheck},$custom)},_this.renderIcon=function(){var loading=_this.props.loading,prefixCls=_this.props.context.prefixCls;return React.createElement("span",{className:classNames("".concat(prefixCls,"-iconEle"),"".concat(prefixCls,"-icon__").concat(_this.getNodeState()||"docu"),loading&&"".concat(prefixCls,"-icon_loading"))})},_this.renderSelector=function(){var $icon,dragNodeHighlight=_this.state.dragNodeHighlight,_this$props6=_this.props,title=_this$props6.title,selected=_this$props6.selected,icon=_this$props6.icon,loading=_this$props6.loading,data=_this$props6.data,_this$props$context3=_this.props.context,prefixCls=_this$props$context3.prefixCls,showIcon=_this$props$context3.showIcon,treeIcon=_this$props$context3.icon,draggable=_this$props$context3.draggable,loadData=_this$props$context3.loadData,titleRender=_this$props$context3.titleRender,disabled=_this.isDisabled(),mergedDraggable="function"==typeof draggable?draggable(data):draggable,wrapClass="".concat(prefixCls,"-node-content-wrapper");if(showIcon){var currentIcon=icon||treeIcon;$icon=currentIcon?React.createElement("span",{className:classNames("".concat(prefixCls,"-iconEle"),"".concat(prefixCls,"-icon__customize"))},"function"==typeof currentIcon?currentIcon(_this.props):currentIcon):_this.renderIcon()}else loadData&&loading&&($icon=_this.renderIcon());var titleNode;titleNode="function"==typeof title?title(data):titleRender?titleRender(data):title;var $title=React.createElement("span",{className:"".concat(prefixCls,"-title")},titleNode);return React.createElement("span",{ref:_this.setSelectHandle,title:"string"==typeof title?title:"",className:classNames("".concat(wrapClass),"".concat(wrapClass,"-").concat(_this.getNodeState()||"normal"),!disabled&&(selected||dragNodeHighlight)&&"".concat(prefixCls,"-node-selected"),!disabled&&mergedDraggable&&"draggable"),draggable:!disabled&&mergedDraggable||void 0,"aria-grabbed":!disabled&&mergedDraggable||void 0,onMouseEnter:_this.onMouseEnter,onMouseLeave:_this.onMouseLeave,onContextMenu:_this.onContextMenu,onClick:_this.onSelectorClick,onDoubleClick:_this.onSelectorDoubleClick,onDragStart:mergedDraggable?_this.onDragStart:void 0},$icon,$title,_this.renderDropIndicator())},_this.renderDropIndicator=function(){var _this$props7=_this.props,disabled=_this$props7.disabled,eventKey=_this$props7.eventKey,_this$props$context4=_this.props.context,draggable=_this$props$context4.draggable,dropLevelOffset=_this$props$context4.dropLevelOffset,dropPosition=_this$props$context4.dropPosition,prefixCls=_this$props$context4.prefixCls,indent=_this$props$context4.indent,dropIndicatorRender=_this$props$context4.dropIndicatorRender,dragOverNodeKey=_this$props$context4.dragOverNodeKey,direction=_this$props$context4.direction;return disabled||!1===draggable||dragOverNodeKey!==eventKey?null:dropIndicatorRender({dropPosition:dropPosition,dropLevelOffset:dropLevelOffset,indent:indent,prefixCls:prefixCls,direction:direction})},_this}_inherits(InternalTreeNode,_React$Component);var _super=_createSuper(InternalTreeNode);return _createClass(InternalTreeNode,[{key:"componentDidMount",value:function componentDidMount(){this.syncLoadData(this.props)}},{key:"componentDidUpdate",value:function componentDidUpdate(){this.syncLoadData(this.props)}},{key:"isSelectable",value:function isSelectable(){var selectable=this.props.selectable,treeSelectable=this.props.context.selectable;return"boolean"==typeof selectable?selectable:treeSelectable}},{key:"render",value:function render(){var _classNames,_this$props8=this.props,eventKey=_this$props8.eventKey,className=_this$props8.className,style=_this$props8.style,dragOver=_this$props8.dragOver,dragOverGapTop=_this$props8.dragOverGapTop,dragOverGapBottom=_this$props8.dragOverGapBottom,isLeaf=_this$props8.isLeaf,isStart=_this$props8.isStart,isEnd=_this$props8.isEnd,expanded=_this$props8.expanded,selected=_this$props8.selected,checked=_this$props8.checked,halfChecked=_this$props8.halfChecked,loading=_this$props8.loading,domRef=_this$props8.domRef,active=_this$props8.active,data=_this$props8.data,onMouseMove=_this$props8.onMouseMove,otherProps=_objectWithoutProperties(_this$props8,["eventKey","className","style","dragOver","dragOverGapTop","dragOverGapBottom","isLeaf","isStart","isEnd","expanded","selected","checked","halfChecked","loading","domRef","active","data","onMouseMove"]),_this$props$context5=this.props.context,prefixCls=_this$props$context5.prefixCls,filterTreeNode=_this$props$context5.filterTreeNode,draggable=_this$props$context5.draggable,keyEntities=_this$props$context5.keyEntities,dropContainerKey=_this$props$context5.dropContainerKey,dropTargetKey=_this$props$context5.dropTargetKey,disabled=this.isDisabled(),dataOrAriaAttributeProps=getDataAndAria(otherProps),_ref2=keyEntities[eventKey]||{},level=_ref2.level,isEndNode=isEnd[isEnd.length-1],mergedDraggable="function"==typeof draggable?draggable(data):draggable;return React.createElement("div",_extends({ref:domRef,className:classNames(className,"".concat(prefixCls,"-treenode"),(_classNames={},_defineProperty(_classNames,"".concat(prefixCls,"-treenode-disabled"),disabled),_defineProperty(_classNames,"".concat(prefixCls,"-treenode-switcher-").concat(expanded?"open":"close"),!isLeaf),_defineProperty(_classNames,"".concat(prefixCls,"-treenode-checkbox-checked"),checked),_defineProperty(_classNames,"".concat(prefixCls,"-treenode-checkbox-indeterminate"),halfChecked),_defineProperty(_classNames,"".concat(prefixCls,"-treenode-selected"),selected),_defineProperty(_classNames,"".concat(prefixCls,"-treenode-loading"),loading),_defineProperty(_classNames,"".concat(prefixCls,"-treenode-active"),active),_defineProperty(_classNames,"".concat(prefixCls,"-treenode-leaf-last"),isEndNode),_defineProperty(_classNames,"drop-target",dropTargetKey===eventKey),_defineProperty(_classNames,"drop-container",dropContainerKey===eventKey),_defineProperty(_classNames,"drag-over",!disabled&&dragOver),_defineProperty(_classNames,"drag-over-gap-top",!disabled&&dragOverGapTop),_defineProperty(_classNames,"drag-over-gap-bottom",!disabled&&dragOverGapBottom),_defineProperty(_classNames,"filter-node",filterTreeNode&&filterTreeNode(convertNodePropsToEventData(this.props))),_classNames)),style:style,onDragEnter:mergedDraggable?this.onDragEnter:void 0,onDragOver:mergedDraggable?this.onDragOver:void 0,onDragLeave:mergedDraggable?this.onDragLeave:void 0,onDrop:mergedDraggable?this.onDrop:void 0,onDragEnd:mergedDraggable?this.onDragEnd:void 0,onMouseMove:onMouseMove},dataOrAriaAttributeProps),React.createElement(Indent,{prefixCls:prefixCls,level:level,isStart:isStart,isEnd:isEnd}),this.renderSwitcher(),this.renderCheckbox(),this.renderSelector())}}]),InternalTreeNode}(React.Component),ContextTreeNode=function ContextTreeNode(props){return React.createElement(TreeContext.Consumer,null,function(context){return React.createElement(InternalTreeNode,_extends({},props,{context:context}))})};ContextTreeNode.displayName="TreeNode",ContextTreeNode.defaultProps={title:defaultTitle},ContextTreeNode.isTreeNode=1;export{InternalTreeNode};export default ContextTreeNode;