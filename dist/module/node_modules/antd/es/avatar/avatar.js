import"/node_modules/core-js/modules/es.array.index-of.js";import _extends from"/node_modules/@babel/runtime/helpers/esm/extends.js";import _defineProperty from"/node_modules/@babel/runtime/helpers/esm/defineProperty.js";import _typeof from"/node_modules/@babel/runtime/helpers/esm/typeof.js";import _slicedToArray from"/node_modules/@babel/runtime/helpers/esm/slicedToArray.js";var __rest=this&&this.__rest||function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&0>e.indexOf(p)&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,p=Object.getOwnPropertySymbols(s);i<p.length;i++)0>e.indexOf(p[i])&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]]);return t};import React from"c:\\node_modules\\react\\index.js";import classNames from"/node_modules/classnames.js";import ResizeObserver from"/node_modules/rc-resize-observer.js";import{composeRef}from"/node_modules/rc-util/es/ref.js";import{ConfigContext}from"/node_modules/antd/es/config-provider.js";import devWarning from"/node_modules/antd/es/_util/devWarning.js";import{responsiveArray}from"/node_modules/antd/es/_util/responsiveObserve.js";import useBreakpoint from"/node_modules/antd/es/grid/hooks/useBreakpoint.js";import SizeContext from"/node_modules/antd/es/avatar/SizeContext.js";var InternalAvatar=function InternalAvatar(props,ref){var _classNames,_classNames2,groupSize=React.useContext(SizeContext),_React$useState=React.useState(1),_React$useState2=_slicedToArray(_React$useState,2),scale=_React$useState2[0],setScale=_React$useState2[1],_React$useState3=React.useState(!1),_React$useState4=_slicedToArray(_React$useState3,2),mounted=_React$useState4[0],setMounted=_React$useState4[1],_React$useState5=React.useState(!0),_React$useState6=_slicedToArray(_React$useState5,2),isImgExist=_React$useState6[0],setIsImgExist=_React$useState6[1],avatarNodeRef=React.useRef(),avatarChildrenRef=React.useRef(),avatarNodeMergeRef=composeRef(ref,avatarNodeRef),_React$useContext=React.useContext(ConfigContext),getPrefixCls=_React$useContext.getPrefixCls,setScaleParam=function setScaleParam(){if(avatarChildrenRef.current&&avatarNodeRef.current){var childrenWidth=avatarChildrenRef.current.offsetWidth,nodeWidth=avatarNodeRef.current.offsetWidth;if(0!==childrenWidth&&0!==nodeWidth){var _props$gap=props.gap,gap=void 0===_props$gap?4:_props$gap;2*gap<nodeWidth&&setScale(nodeWidth-2*gap<childrenWidth?(nodeWidth-2*gap)/childrenWidth:1)}}};React.useEffect(function(){setMounted(!0)},[]),React.useEffect(function(){setIsImgExist(!0),setScale(1)},[props.src]),React.useEffect(function(){setScaleParam()},[props.gap]);var handleImgLoadError=function handleImgLoadError(){var onError=props.onError,errorFlag=onError?onError():void 0;!1!==errorFlag&&setIsImgExist(!1)},customizePrefixCls=props.prefixCls,shape=props.shape,customSize=props.size,src=props.src,srcSet=props.srcSet,icon=props.icon,className=props.className,alt=props.alt,draggable=props.draggable,children=props.children,others=__rest(props,["prefixCls","shape","size","src","srcSet","icon","className","alt","draggable","children"]),size="default"===customSize?groupSize:customSize,screens=useBreakpoint(),responsiveSizeStyle=React.useMemo(function(){if("object"!==_typeof(size))return{};var currentBreakpoint=responsiveArray.find(function(screen){return screens[screen]}),currentSize=size[currentBreakpoint];return currentSize?{width:currentSize,height:currentSize,lineHeight:"".concat(currentSize,"px"),fontSize:icon?currentSize/2:18}:{}},[screens,size]);devWarning(!("string"==typeof icon&&2<icon.length),"Avatar","`icon` is using ReactNode instead of string naming in v4. Please check `".concat(icon,"` at https://ant.design/components/icon"));var childrenToRender,prefixCls=getPrefixCls("avatar",customizePrefixCls),sizeCls=classNames((_classNames={},_defineProperty(_classNames,"".concat(prefixCls,"-lg"),"large"===size),_defineProperty(_classNames,"".concat(prefixCls,"-sm"),"small"===size),_classNames)),hasImageElement=React.isValidElement(src),classString=classNames(prefixCls,sizeCls,(_classNames2={},_defineProperty(_classNames2,"".concat(prefixCls,"-").concat(shape),shape),_defineProperty(_classNames2,"".concat(prefixCls,"-image"),hasImageElement||src&&isImgExist),_defineProperty(_classNames2,"".concat(prefixCls,"-icon"),icon),_classNames2),className),sizeStyle="number"==typeof size?{width:size,height:size,lineHeight:"".concat(size,"px"),fontSize:icon?size/2:18}:{};if("string"==typeof src&&isImgExist)childrenToRender=React.createElement("img",{src:src,draggable:draggable,srcSet:srcSet,onError:handleImgLoadError,alt:alt});else if(hasImageElement)childrenToRender=src;else if(icon)childrenToRender=icon;else if(mounted||1!==scale){var transformString="scale(".concat(scale,") translateX(-50%)"),sizeChildrenStyle="number"==typeof size?{lineHeight:"".concat(size,"px")}:{};childrenToRender=React.createElement(ResizeObserver,{onResize:setScaleParam},React.createElement("span",{className:"".concat(prefixCls,"-string"),ref:function ref(node){avatarChildrenRef.current=node},style:_extends(_extends({},sizeChildrenStyle),{msTransform:transformString,WebkitTransform:transformString,transform:transformString})},children))}else childrenToRender=React.createElement("span",{className:"".concat(prefixCls,"-string"),style:{opacity:0},ref:function ref(node){avatarChildrenRef.current=node}},children);return delete others.onError,delete others.gap,React.createElement("span",_extends({},others,{style:_extends(_extends(_extends({},sizeStyle),responsiveSizeStyle),others.style),className:classString,ref:avatarNodeMergeRef}),childrenToRender)},Avatar=React.forwardRef(InternalAvatar);Avatar.displayName="Avatar",Avatar.defaultProps={shape:"circle",size:"default"};export default Avatar;